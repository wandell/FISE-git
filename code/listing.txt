human-02-spatial-encoding.qmd:ISETBio simulations of the cone sampling mosaic at four different eccentricities. Source: fise_humanMosaic.m
human-02-spatial-encoding.qmd:<!-- See fise_humanConePSF.m in code/human -->
human-02-spatial-encoding.qmd:ISETBio simulations of the PSF superimposed on the cone sampling mosaic at four different eccentricities. For an example subject based on Artal optics measurements. Source: fise_humanOpticsPSFm
human-02-spatial-encoding.qmd:<!-- See fise_humanConePSF.m in code/human -->
human-02-spatial-encoding.qmd:Point spread function for different wavelengths, superimposed on the foveal sampling mosaic. (Source:  fise_humanConePSF.m)
human-03-wavelength-encoding.qmd:fise_human* script exists.
optics-01-geometric.qmd:The diffraction spread is larger than the pinhole spread when $d$ exceeds $D$. We do the calculation in the scripts in this [ISETCam script](https://htmlpreview.github.io/?https://github.com/wandell/FISE-git/blob/main/code/fise_diffraction.html).  For $L = 1m$ the pinhole blur is larger than the diffraction blur for a diameter of about $1 mm$.  When $L$ is much closer, say $10 mm$, the pinhole blur exceeds the diffraction blur when the diameter is $100 \mu$.
optics-01-geometric.qmd:The diffraction spread exceeds the pinhole spread when $d$ exceeds $D$. We do the calculation for different assumptions about the distance to the image plane [ISETCam:fise_diffraction](../code/02Optics/fise_diffraction.html). As an example, we find that when the distance to the image plane is $L = 1m$, the pinhole blur is larger than the diffraction blur for a pinhole diameter of about $1 mm$. When the image plane distance, $L$, is closer, say $10 mm$, the pinhole blur exceeds the diffraction blur when the diameter is $100 \mu$.
optics-01-geometric.qmd:The script [fise_oiAperture](../code/02Optics/fise_oiAperture.html){target=_blank} illustrates how to calculate the PSF for a rectangular aperture in ISETCam. An image computed using the PSF from a diffraction limited rectangular pinhole, and the PSF for that pinhole, are shown in @fig-pinhole-rectangle. The images illustrate a case for the rectangular aperture is three times wider (x) than high (y). The larger vertical height causes less blur in the y-direction, making the image sharper for the horizontal stripes.
optics-01-geometric.qmd:![Simulating a diffraction-limited rectangular pinhole that is 3x higher than wide. The test pattern has spatial frequency increasing from left to right, and orientation varying up to down. The horizontal lines retain their contrast as frequency increases; the vertical lines lose theirs. The PSF (550 nm) for the rectangular aperture is plotted on the right. See [fise_oiAperture](../code/02Optics/fise_oiAperture.html){target=_blank}.](images/optics/06-geometric/pinhole-rectangle-both.png){#fig-pinhole-rectangle width="80%"}
optics-01-geometric.qmd:The impact of the regular polygon shape is quite visible in high dynamic range (HDR) scenes that include light sources.  The script [fise_oiAperture](../code/02Optics/fise_oiAperture.html){target=_blank} simulates an HDR scene, superimposing some very bright light sources on the background image.  These apertures produce the flare pattern that one often sees in professional productions, including movies and sports shows. The three images show the flare pattern for polygons with different numbers of sides.
optics-02-lenses.qmd:Let me tell you what I mean by **small**. Suppose we are in a dim room illuminated with a broad wavelength spectrum (10 $cd/m^2$). Consider a camera with a 1 mm pinhole, a sensor with 1 micron pixels, a focal length of 4mm, and an exposure duration of 50 milliseconds. In that case only about 35 photons arrive at each pixel. If we want to see in color, we must further divide up the wavelength range and the situation worsens. Because of the inescapable photon noise, which I describe later, this signal only permits a reliable intensity discrimination when two pixels differ by more than 20% (i.e., one edge is 20% brighter than the other, see [fise_opticsCountingPhotons](../code/02Optics/fise_opticsCountingPhotons.html)).
optics-02-lenses.qmd:[See this page and fise_aspherics.m for the shape formula of aspherical lenses.](https://chatgpt.com/c/6748e492-0310-8002-8da3-89a1517a6062).[Also this page.](https://g.co/gemini/share/a89a3d193d26)
optics-04-morelenses.qmd:![Double Gauss multielement lens design. fise_lensExample.m initiated the drawing, which I modified in Affinity Designer. The evolution from Gauss' original lens design to the double Gauss and Planar design is nicely illustrated in [Wikipedia Double-Gauss](https://en.wikipedia.org/wiki/Double-Gauss_lens).](images/optics/09-morelens/double-gauss-isetlens.png){#fig-double-gauss width="60%"}
optics-05-linear-space.qmd:The calculation is illustrated in the script [fise_ImageFormationLinearity](../code/02Optics/fise_ImageFormationLinearity.html){target=_blank}.  I created a random image to serve as the PSF for each pixel, and naturally the image looks completely random.  But with knowlege of the PSFs, and thus the system matrix, we can find the inverse of the system matrix and estimate the input from an image that appears to be complete noise.
optics-05-linear-space.qmd:We can simulate how the four PSF shapes transform a spectral radiance (@fig-psf-image). We compare the optical images four each of the PSFs for a scene comprising a set of grid lines. The images were calculated using the ISETCam script <a href="../code/02Optics/fise_opticsPSF.html" target="_blank">fise_opticsPSF.</a>  The Airy and Gaussian PSFs were implemented with wavelength-dependent point spread functions. The Pillbox and Lorentzian PSFs were implemented as wavelength-indepedent.
optics-05-linear-space.qmd:Typical human line spread functions or point spread functions for stimuli with equal energy, 425 nm, 525 nm, and 625 nm. Source: ISETBio <a href="../code/02Optics/fise_humanLSF.html" target="_blank">Human LSF</a>.
optics-06-linear-transform.qmd:![A set of one-dimensional image harmonics. They vary in $x$ with $f_y = 0$. The contrast $A$ varies from top to bottom $(1, 0.5, 0.1)$. The $x$-range is $(0,1)$, and the spatial frequencies are $f_x = (1, 2, 4, 8)$. [fise_imageHarmonics1d.m](../code/02Optics/fise_imageHarmonics1d.html){target=_blank}](images/optics/11-transform/optics-harmonics-1d.png){#fig-optics-harmonics-1d width="60%"}
optics-06-linear-transform.qmd:![Video showing a line reconstructed as we add harmonics (cosines) at different frequencies. I only added the contrast terms, keeping the mean the same. See [fise_harmonicsLine](../code/02Optics/fise_harmonicsLine.html){target=_blank}. ](images/optics/11-transform/lineReconstruct.mp4){#fig-optics-reconstruction-movie width="40%" fig-align="center"}
optics-06-linear-transform.qmd:![Video showing a line reconstructed as we add harmonics (cosines) at different frequencies. I only added the contrast terms, keeping the mean the same. See [fise_harmonicsLine](../code/02Optics/fise_harmonicsLine.html){target=_blank}. ](images/optics/11-transform/lineReconstruct-still.png){#fig-optics-reconstruction-movie width="40%" fig-align="center"}
optics-06-linear-transform.qmd:![Pictures of 2d FFT Amplitude spectrum. [See fise_otf2d](../code/02Optics/fise_otf2d.html){target=_blank}](images/optics/11-transform/otf2d.png){#fig-optics-otf2d width=70%}
optics-06-linear-transform.qmd:![The $\log_{10}$ amplitudes of the two-dimensional Fourier Transform coefficients are shown in the bottom row; the corresponding images are shown in the top row.[fise_otf2dFace](../code/02Optics/fise_otf2dFace.html){target=_blank}](images/optics/11-transform/otf2dFace.png){#fig-optics-otf2dparts width=70%}
sensors-01-photoelectric.qmd:You can see a step-by-step statistical explanation of photon arrivals followed by electron generation in the [ISETCam script](../code/03Sensor/fise_photonsElectrons.html){target=_blank}. The script demonstrates why, in conventional CMOS image sensors, both the incident photons and the resulting electrons follow Poisson statistics. 
sensors-02-pixels.qmd:This [ISETCam script](../code/03Sensor/fise_sensorRollingShutter.html){target=_blank} simulates a rolling shutter. The timing and spatial parameter details of the sensor are included.
sensors-03-parameters.qmd:This [ISETCam script](../code/02Optics/fise_opticsCountingPhotons.html){target=_blank} illustrates the calculation. Nearly every sensor simulation we run in ISETCam includes calculations like this.
