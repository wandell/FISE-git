<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2025a"><title>fise_otf2d</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(192, 76, 11); font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 24px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-style: normal; font-size: 16px; font-weight: 400; text-align: left;  }
.S2 { margin: 20px 10px 5px 4px; padding: 0px; line-height: 25px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.CodeBlock { background-color: #F5F5F5; margin: 10px 15px 10px 0; display: inline-block; min-width: 100%; }
.S3 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 1px solid rgb(217, 217, 217); border-bottom: 1px solid rgb(217, 217, 217); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S4 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 25px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S5 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 1px solid rgb(217, 217, 217); border-bottom: 0px none rgb(33, 33, 33); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S6 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S7 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 1px solid rgb(217, 217, 217); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.eoOutputWrapper { width: calc(90vw - 10px) !important; }
.S8 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 1px solid rgb(217, 217, 217); border-bottom: 1px solid rgb(217, 217, 217); border-radius: 4px 4px 0px 0px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S9 { color: rgb(33, 33, 33); padding: 10px 0px 6px 17px; background: rgb(255, 255, 255) none repeat scroll 0% 0% / auto padding-box border-box; font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px; overflow-x: hidden; line-height: 17.234px;  }
.S10 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 1px solid rgb(217, 217, 217); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }</style></head><body><div class = rtcContent><h1  class = 'S0'><span>fise_otf2d</span></h1><div  class = 'S1'><span>Illustrate the 2D Fourier representation of luminance images.</span></div><div  class = 'S1'><span>The Fourier transform is complex-valued.  When the image is real, the complex values obey symmetry conditions, such that</span></div><div  class = 'S1'><span texencoding="F(u,v) = F^*(-u,-v)" style="vertical-align:-7px"><img src="data:image/png;base64,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" width="199.5" height="31.5" /></span><span> </span></div><div  class = 'S1'><span>* is complex conjugate.  This implies the amplitudes at those two locations are the same.</span></div><div  class = 'S1'><span>Also, for image harmonics the mean value is positive.  So there will also be a positive value at </span><span texencoding="(0,0)" style="vertical-align:-7px"><img src="data:image/png;base64,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" width="53" height="28" /></span><span>..</span></div><h2  class = 'S2'><span>ISETCam initialization</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >ieInit;</span></span></div></div></div><h2  class = 'S4'><span>Create a test image</span></h2><div  class = 'S1'><span>Harmonics are very simple because they are 'points' in the transform domain.  So let's start with that.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >params = harmonicP;    </span><span style="color: rgb(0, 128, 19);">% Creates a struct of harmonic parameters</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >params.freq = 8;       </span><span style="color: rgb(0, 128, 19);">% Cycles per image</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >params.row = 33; params.col = 33;  </span><span style="color: rgb(0, 128, 19);">% Image size</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >scene = sceneCreate(</span><span style="color: rgb(167, 9, 245);">'harmonic'</span><span >,params);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >scene = sceneSet(scene,</span><span style="color: rgb(167, 9, 245);">'fov'</span><span >,1);   </span><span style="color: rgb(0, 128, 19);">% Making it 1 deg is simple</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% Spatial frequency support.</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >fx = sceneGet(scene,</span><span style="color: rgb(167, 9, 245);">'f support x'</span><span >); fullFx = [-1*fliplr(fx), fx];</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >fy = sceneGet(scene,</span><span style="color: rgb(167, 9, 245);">'f support y'</span><span >); fullFy = [-1*fliplr(fy), fy];</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% Space support.</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >x = sceneGet(scene,</span><span style="color: rgb(167, 9, 245);">'spatial support x'</span><span >,</span><span style="color: rgb(167, 9, 245);">'deg'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >y = sceneGet(scene,</span><span style="color: rgb(167, 9, 245);">'spatial support y'</span><span >,</span><span style="color: rgb(167, 9, 245);">'deg'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% sceneWindow(scene);</span></span></div></div></div><h2  class = 'S4'><span>Operate on luminance - for simplicity</span></h2><div  class = 'S1'><span>One harmonic is vertical and then we create a different harmonic at 45 deg angle.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >img = sceneGet(scene,</span><span style="color: rgb(167, 9, 245);">'luminance'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% The 2D Fourier transform</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >imgF = fft2(img);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% We build up the figure</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >ieFigure;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >tiledlayout(2,2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >nexttile</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >imagesc(x,y,img); axis </span><span style="color: rgb(167, 9, 245);">image</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >xlabel(</span><span style="color: rgb(167, 9, 245);">'Position (deg)'</span><span >); ylabel(</span><span style="color: rgb(167, 9, 245);">'Position (deg)'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >nexttile;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >imagesc(fullFx,fullFy,abs(fftshift(imgF))); </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >axis </span><span style="color: rgb(167, 9, 245);">equal</span><span >; axis </span><span style="color: rgb(167, 9, 245);">image</span><span >; colormap(gray);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >set(gca, </span><span style="color: rgb(167, 9, 245);">'Color'</span><span >, </span><span style="color: rgb(167, 9, 245);">'k'</span><span >); </span><span style="color: rgb(0, 128, 19);">% Set background color to black</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >grid </span><span style="color: rgb(167, 9, 245);">on</span><span >; </span><span style="color: rgb(0, 128, 19);">% Turn on the grid</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >ax = gca; </span><span style="color: rgb(0, 128, 19);">% Get current axes</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >ax.GridColor = [0.7 0.7 0.7]; </span><span style="color: rgb(0, 128, 19);">% Set grid color to dark gray</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >ax.GridLineStyle = </span><span style="color: rgb(167, 9, 245);">'-'</span><span >; </span><span style="color: rgb(0, 128, 19);">% Set grid line style</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >ax.LineWidth = 3; </span><span style="color: rgb(0, 128, 19);">% Set grid line thickness</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >xlabel(</span><span style="color: rgb(167, 9, 245);">'Frequency (cyc/deg'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >ylabel(</span><span style="color: rgb(167, 9, 245);">'Frequency (cyc/deg'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% A different harmonic</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >params.ang = 45;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >[scene,parms] = sceneCreate(</span><span style="color: rgb(167, 9, 245);">'harmonic'</span><span >,params);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >scene = sceneSet(scene,</span><span style="color: rgb(167, 9, 245);">'fov'</span><span >,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >img = sceneGet(scene,</span><span style="color: rgb(167, 9, 245);">'luminance'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >imgF = fft2(img);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >nexttile</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >imagesc(x,y,img); axis </span><span style="color: rgb(167, 9, 245);">image</span><span >; </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >xlabel(</span><span style="color: rgb(167, 9, 245);">'Position (deg)'</span><span >); ylabel(</span><span style="color: rgb(167, 9, 245);">'Position (deg)'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >nexttile;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >imagesc(fullFx,fullFy,abs(fftshift(imgF))); </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >axis </span><span style="color: rgb(167, 9, 245);">equal</span><span >; axis </span><span style="color: rgb(167, 9, 245);">image</span><span >; colormap(gray);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >set(gca, </span><span style="color: rgb(167, 9, 245);">'Color'</span><span >, </span><span style="color: rgb(167, 9, 245);">'k'</span><span >); </span><span style="color: rgb(0, 128, 19);">% Set background color to black</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >grid </span><span style="color: rgb(167, 9, 245);">on</span><span >; </span><span style="color: rgb(0, 128, 19);">% Turn on the grid</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >ax = gca; </span><span style="color: rgb(0, 128, 19);">% Get current axes</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >ax.GridColor = [0.7 0.7 0.7]; </span><span style="color: rgb(0, 128, 19);">% Set grid color to dark gray</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >ax.GridLineStyle = </span><span style="color: rgb(167, 9, 245);">'-'</span><span >; </span><span style="color: rgb(0, 128, 19);">% Set grid line style</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >ax.LineWidth = 3; </span><span style="color: rgb(0, 128, 19);">% Set grid line thickness</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >xlabel(</span><span style="color: rgb(167, 9, 245);">'Frequency (cyc/deg'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >ylabel(</span><span style="color: rgb(167, 9, 245);">'Frequency (cyc/deg'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%{</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% Write out the figure as a PNG.</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">theDir = fullfile(fiseRootPath,'chapters','images','optics');</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">exportgraphics(gcf,fullfile(theDir,'otf2d.png'));</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%}</span></span></div></div></div><h2  class = 'S4'><span>A face image</span></h2><div  class = 'S1'><span>Force the scene to have an odd number of rows and columns.  Also 10 deg, which is more typical of viewing distance and sampling density.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >scene = sceneFromFile(</span><span style="color: rgb(167, 9, 245);">'faceMale.jpg'</span><span >,</span><span style="color: rgb(167, 9, 245);">'rgb'</span><span >,[],displayCreate);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >scene = sceneSet(scene,</span><span style="color: rgb(167, 9, 245);">'fov'</span><span >,10);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >imSize = sceneGet(scene,</span><span style="color: rgb(167, 9, 245);">'size'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >newSize = round(imSize/2)*2 - 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >scene = sceneCrop(scene,[1 1 newSize(1)-1 newSize(2)-1]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% Spatial frequency support.</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >fx = sceneGet(scene,</span><span style="color: rgb(167, 9, 245);">'f support x'</span><span >); fullFx = [-1*fliplr(fx), fx];</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >fy = sceneGet(scene,</span><span style="color: rgb(167, 9, 245);">'f support y'</span><span >); fullFy = [-1*fliplr(fy), fy];</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% Space support.</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >x = sceneGet(scene,</span><span style="color: rgb(167, 9, 245);">'spatial support x'</span><span >,</span><span style="color: rgb(167, 9, 245);">'deg'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >y = sceneGet(scene,</span><span style="color: rgb(167, 9, 245);">'spatial support y'</span><span >,</span><span style="color: rgb(167, 9, 245);">'deg'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% sceneWindow(scene);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >img = sceneGet(scene, </span><span style="color: rgb(167, 9, 245);">'luminance'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'>&nbsp;</div></div></div><h2  class = 'S4'><span>Display the loaded face image</span></h2><div  class = 'S1'><span>Shows the images and corresponding Fourier Transform amplitude representations in the top and bottom rows.</span></div><div class="CodeBlock"><div class="inlineWrapper outputs"><div  class = 'S8'><span style="white-space: pre"><span >ieFigure;</span></span></div><div  class = 'S9'><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsFigure" uid="9AF37FF2" prevent-scroll="true" data-testid="output_0" style="width: 1117.82px;" tabindex="-1"><div class="outputLayer selectedOutputDecorationLayer doNotExport" aria-hidden="true"></div><div class="outputLayer activeOutputDecorationLayer doNotExport" aria-hidden="true"></div><div class="outputLayer scrollableOutputDecorationLayer doNotExport" aria-hidden="true"></div><div class="outputLayer navigationFocusLayer doNotExport" aria-hidden="false" role="application" tabindex="-1"></div><div class="figureElement eoOutputContent" role="article" aria-roledescription="Use Browse Mode to explore " aria-description="figure output "><img class="figureImage figureContainingNode" src="data:image/png;base64,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" style="width: 159px;"></div></div></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >subplot(2,3,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >imagesc(x,y,img); axis </span><span style="color: rgb(167, 9, 245);">image</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >xlabel(</span><span style="color: rgb(167, 9, 245);">'Position (deg)'</span><span >); ylabel(</span><span style="color: rgb(167, 9, 245);">'Position (deg)'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >drawnow;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% Now the log of the FFT amplitude.</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >subplot(2,3,4);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >imgF = fft2(img);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >imagesc(fullFx,fullFy,log10(abs(fftshift(imgF)))); </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >axis </span><span style="color: rgb(167, 9, 245);">equal</span><span >; axis </span><span style="color: rgb(167, 9, 245);">image</span><span >; colormap(gray);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >set(gca, </span><span style="color: rgb(167, 9, 245);">'Color'</span><span >, </span><span style="color: rgb(167, 9, 245);">'k'</span><span >); </span><span style="color: rgb(0, 128, 19);">% Set background color to black</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >grid </span><span style="color: rgb(167, 9, 245);">on</span><span >; </span><span style="color: rgb(0, 128, 19);">% Turn on the grid</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >ax = gca; </span><span style="color: rgb(0, 128, 19);">% Get current axes</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >ax.GridColor = [0.7 0.7 0.7]; </span><span style="color: rgb(0, 128, 19);">% Set grid color to dark gray</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >ax.GridLineStyle = </span><span style="color: rgb(167, 9, 245);">'-'</span><span >; </span><span style="color: rgb(0, 128, 19);">% Set grid line style</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >ax.LineWidth = 3; </span><span style="color: rgb(0, 128, 19);">% Set grid line thickness</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >xlabel(</span><span style="color: rgb(167, 9, 245);">'Frequency (cyc/deg)'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >ylabel(</span><span style="color: rgb(167, 9, 245);">'Frequency (cyc/deg)'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >drawnow;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%{</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% Show that we can invert the FFT to reconstruct the image</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">nexttile</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">imagesc(x,y,fliplr(abs(fft2(imgF)))); % Corrected to display the magnitude of the Fourier transform</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">axis equal; axis xy; axis off</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">title('Reconstructed image.');</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%}</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%% Create a Gaussian kernel </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% Reduce low frequency terms </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% mesh(FX,FY,lowFreqReduction);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >[FX, FY] = meshgrid(fullFx(1:(end-1)), fullFy(1:(end-1)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% Standard deviation for the Gaussian</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >sigma = 0.6;   </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >lowFreqReduction = 1 - exp(-(FX.^2 + FY.^2) / (2 * sigma^2));</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%% Apply the Gaussian kernel to imgF, worrying about the fftshift</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >subplot(2,3,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >imgF_reduced = fftshift(imgF) .* (lowFreqReduction);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >imagesc(x,y,fliplr(abs(fft2(fftshift(imgF_reduced))))); </span><span style="color: rgb(0, 128, 19);">% Corrected to display the magnitude of the Fourier transform</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >axis </span><span style="color: rgb(167, 9, 245);">equal</span><span >; axis </span><span style="color: rgb(167, 9, 245);">xy</span><span >; axis </span><span style="color: rgb(167, 9, 245);">off</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >drawnow;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% Show the scaled FFT</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >subplot(2,3,5);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >imagesc(fullFx,fullFy,log10(abs(imgF_reduced))); </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >axis </span><span style="color: rgb(167, 9, 245);">equal</span><span >; axis </span><span style="color: rgb(167, 9, 245);">image</span><span >; colormap(gray);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >set(gca, </span><span style="color: rgb(167, 9, 245);">'Color'</span><span >, </span><span style="color: rgb(167, 9, 245);">'k'</span><span >); </span><span style="color: rgb(0, 128, 19);">% Set background color to black</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >grid </span><span style="color: rgb(167, 9, 245);">on</span><span >; </span><span style="color: rgb(0, 128, 19);">% Turn on the grid</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >ax = gca; </span><span style="color: rgb(0, 128, 19);">% Get current axes</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >ax.GridColor = [0.7 0.7 0.7]; </span><span style="color: rgb(0, 128, 19);">% Set grid color to dark gray</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >ax.GridLineStyle = </span><span style="color: rgb(167, 9, 245);">'-'</span><span >; </span><span style="color: rgb(0, 128, 19);">% Set grid line style</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >ax.LineWidth = 3; </span><span style="color: rgb(0, 128, 19);">% Set grid line thickness</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >drawnow;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% Flip the reduction</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >subplot(2,3,3);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >imgF_reduced = fftshift(imgF) .* (1-lowFreqReduction);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >imagesc(x,y,fliplr(abs(fft2(fftshift(imgF_reduced))))); </span><span style="color: rgb(0, 128, 19);">% Corrected to display the magnitude of the Fourier transform</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >axis </span><span style="color: rgb(167, 9, 245);">equal</span><span >; axis </span><span style="color: rgb(167, 9, 245);">xy</span><span >; axis </span><span style="color: rgb(167, 9, 245);">off</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% Show the transform itself</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >subplot(2,3,6);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >imagesc(fullFx,fullFy,log10(abs(imgF_reduced))); </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >axis </span><span style="color: rgb(167, 9, 245);">equal</span><span >; axis </span><span style="color: rgb(167, 9, 245);">image</span><span >; colormap(gray);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >set(gca, </span><span style="color: rgb(167, 9, 245);">'Color'</span><span >, </span><span style="color: rgb(167, 9, 245);">'k'</span><span >); </span><span style="color: rgb(0, 128, 19);">% Set background color to black</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >grid </span><span style="color: rgb(167, 9, 245);">on</span><span >; </span><span style="color: rgb(0, 128, 19);">% Turn on the grid</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >ax = gca; </span><span style="color: rgb(0, 128, 19);">% Get current axes</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >ax.GridColor = [0.7 0.7 0.7]; </span><span style="color: rgb(0, 128, 19);">% Set grid color to dark gray</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >ax.GridLineStyle = </span><span style="color: rgb(167, 9, 245);">'-'</span><span >; </span><span style="color: rgb(0, 128, 19);">% Set grid line style</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >ax.LineWidth = 3; </span><span style="color: rgb(0, 128, 19);">% Set grid line thickness</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >drawnow;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%{</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">theDir = fullfile(fiseRootPath,'chapters','images','optics');</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">exportgraphics(gcf,fullfile(theDir,'otf2dParts.png'));</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%}</span></span></div></div></div><h2  class = 'S4'><span>End</span></h2>
<br>
<!-- 
##### SOURCE BEGIN #####
%% fise_otf2d
% Illustrate the 2D Fourier representation of luminance images.
% 
% The Fourier transform is complex-valued.  When the image is real, the complex 
% values obey symmetry conditions, such that
% 
% $$F(u,v) = F^*(-u,-v)$$ 
% 
% * is complex conjugate.  This implies the amplitudes at those two locations 
% are the same.
% 
% Also, for image harmonics the mean value is positive.  So there will also 
% be a positive value at $(0,0)$..
%% ISETCam initialization

ieInit;
%% Create a test image
% Harmonics are very simple because they are 'points' in the transform domain.  
% So let's start with that.

params = harmonicP;    % Creates a struct of harmonic parameters
params.freq = 8;       % Cycles per image

params.row = 33; params.col = 33;  % Image size
scene = sceneCreate('harmonic',params);
scene = sceneSet(scene,'fov',1);   % Making it 1 deg is simple

% Spatial frequency support.
fx = sceneGet(scene,'f support x'); fullFx = [-1*fliplr(fx), fx];
fy = sceneGet(scene,'f support y'); fullFy = [-1*fliplr(fy), fy];

% Space support.
x = sceneGet(scene,'spatial support x','deg');
y = sceneGet(scene,'spatial support y','deg');

% sceneWindow(scene);
%% Operate on luminance - for simplicity
% One harmonic is vertical and then we create a different harmonic at 45 deg 
% angle.

img = sceneGet(scene,'luminance');

% The 2D Fourier transform
imgF = fft2(img);

% We build up the figure
ieFigure;

tiledlayout(2,2)

nexttile
imagesc(x,y,img); axis image
xlabel('Position (deg)'); ylabel('Position (deg)');

nexttile;
imagesc(fullFx,fullFy,abs(fftshift(imgF))); 
axis equal; axis image; colormap(gray);
set(gca, 'Color', 'k'); % Set background color to black
grid on; % Turn on the grid
ax = gca; % Get current axes
ax.GridColor = [0.7 0.7 0.7]; % Set grid color to dark gray
ax.GridLineStyle = '-'; % Set grid line style
ax.LineWidth = 3; % Set grid line thickness
xlabel('Frequency (cyc/deg');
ylabel('Frequency (cyc/deg');

% A different harmonic
params.ang = 45;
[scene,parms] = sceneCreate('harmonic',params);
scene = sceneSet(scene,'fov',1);
img = sceneGet(scene,'luminance');
imgF = fft2(img);

nexttile
imagesc(x,y,img); axis image; 
xlabel('Position (deg)'); ylabel('Position (deg)');
nexttile;
imagesc(fullFx,fullFy,abs(fftshift(imgF))); 
axis equal; axis image; colormap(gray);
set(gca, 'Color', 'k'); % Set background color to black
grid on; % Turn on the grid
ax = gca; % Get current axes
ax.GridColor = [0.7 0.7 0.7]; % Set grid color to dark gray
ax.GridLineStyle = '-'; % Set grid line style
ax.LineWidth = 3; % Set grid line thickness
xlabel('Frequency (cyc/deg');
ylabel('Frequency (cyc/deg');

%{
% Write out the figure as a PNG.
theDir = fullfile(fiseRootPath,'chapters','images','optics');
exportgraphics(gcf,fullfile(theDir,'otf2d.png'));
%}
%% A face image
% Force the scene to have an odd number of rows and columns.  Also 10 deg, which 
% is more typical of viewing distance and sampling density.

scene = sceneFromFile('faceMale.jpg','rgb',[],displayCreate);
scene = sceneSet(scene,'fov',10);
imSize = sceneGet(scene,'size');
newSize = round(imSize/2)*2 - 1;
scene = sceneCrop(scene,[1 1 newSize(1)-1 newSize(2)-1]);

% Spatial frequency support.
fx = sceneGet(scene,'f support x'); fullFx = [-1*fliplr(fx), fx];
fy = sceneGet(scene,'f support y'); fullFy = [-1*fliplr(fy), fy];

% Space support.
x = sceneGet(scene,'spatial support x','deg');
y = sceneGet(scene,'spatial support y','deg');

% sceneWindow(scene);
img = sceneGet(scene, 'luminance');

%% Display the loaded face image
% Shows the images and corresponding Fourier Transform amplitude representations 
% in the top and bottom rows.

ieFigure;
subplot(2,3,1);

imagesc(x,y,img); axis image
xlabel('Position (deg)'); ylabel('Position (deg)');
drawnow;

% Now the log of the FFT amplitude.
subplot(2,3,4);
imgF = fft2(img);
imagesc(fullFx,fullFy,log10(abs(fftshift(imgF)))); 
axis equal; axis image; colormap(gray);
set(gca, 'Color', 'k'); % Set background color to black
grid on; % Turn on the grid
ax = gca; % Get current axes
ax.GridColor = [0.7 0.7 0.7]; % Set grid color to dark gray
ax.GridLineStyle = '-'; % Set grid line style
ax.LineWidth = 3; % Set grid line thickness
xlabel('Frequency (cyc/deg)');
ylabel('Frequency (cyc/deg)');
drawnow;
%{
% Show that we can invert the FFT to reconstruct the image
nexttile
imagesc(x,y,fliplr(abs(fft2(imgF)))); % Corrected to display the magnitude of the Fourier transform
axis equal; axis xy; axis off
title('Reconstructed image.');
%}

%% Create a Gaussian kernel 
% Reduce low frequency terms 
% mesh(FX,FY,lowFreqReduction);

[FX, FY] = meshgrid(fullFx(1:(end-1)), fullFy(1:(end-1)));

% Standard deviation for the Gaussian
sigma = 0.6;   
lowFreqReduction = 1 - exp(-(FX.^2 + FY.^2) / (2 * sigma^2));

%% Apply the Gaussian kernel to imgF, worrying about the fftshift
subplot(2,3,2);
imgF_reduced = fftshift(imgF) .* (lowFreqReduction);
imagesc(x,y,fliplr(abs(fft2(fftshift(imgF_reduced))))); % Corrected to display the magnitude of the Fourier transform
axis equal; axis xy; axis off
drawnow;

% Show the scaled FFT
subplot(2,3,5);
imagesc(fullFx,fullFy,log10(abs(imgF_reduced))); 
axis equal; axis image; colormap(gray);
set(gca, 'Color', 'k'); % Set background color to black
grid on; % Turn on the grid
ax = gca; % Get current axes
ax.GridColor = [0.7 0.7 0.7]; % Set grid color to dark gray
ax.GridLineStyle = '-'; % Set grid line style
ax.LineWidth = 3; % Set grid line thickness
drawnow;

% Flip the reduction
subplot(2,3,3);
imgF_reduced = fftshift(imgF) .* (1-lowFreqReduction);
imagesc(x,y,fliplr(abs(fft2(fftshift(imgF_reduced))))); % Corrected to display the magnitude of the Fourier transform
axis equal; axis xy; axis off

% Show the transform itself
subplot(2,3,6);
imagesc(fullFx,fullFy,log10(abs(imgF_reduced))); 
axis equal; axis image; colormap(gray);
set(gca, 'Color', 'k'); % Set background color to black
grid on; % Turn on the grid
ax = gca; % Get current axes
ax.GridColor = [0.7 0.7 0.7]; % Set grid color to dark gray
ax.GridLineStyle = '-'; % Set grid line style
ax.LineWidth = 3; % Set grid line thickness
drawnow;

%{
theDir = fullfile(fiseRootPath,'chapters','images','optics');
exportgraphics(gcf,fullfile(theDir,'otf2dParts.png'));
%}
%% End
##### SOURCE END #####
-->
</div></body></html>