---
date: last-modified
---

# Human spatial encoding {#sec-human-spatial-encoding}

{{< include "includes/WIP-callout.qmd" >}}

```{=html}
<!--
# The chapters with David have a lot of the material for this chapter.
-->
```

The material about human vision in this chapter is under development.

Please refer to the chapters in [Foundations of Vision](https://foundationsofvision.stanford.edu){target="_blank"}.

-   [Retina](https://wandell.github.io/FOV-1995/chapter-5-the-retinal-representation.html){target="_blank"}
-   [Pattern sensitivity](https://wandell.github.io/FOV-1995/chapter-7-pattern-sensitivity.html){target="_blank"}

## Human spatial encoding overview {#sec-human-spatial-encoding-overview}


## The Two Stages of Encoding {#sec-human-encoding-systems}

The process of converting light from the world into a neural signal that the brain can interpret happens in two main stages, as illustrated in @fig-eye-and-retina.

First, the **physiological optics**—the cornea and lens—act like a camera lens. They gather the light entering the eye and focus it to form an image on the retina. This stage transforms the light from the environment into a focused optical image.

Second, the **retina**, a thin layer of neural tissue lining the back of the eye, converts this optical image into electrical signals. This process, called transduction, is performed by specialized cells called **photoreceptors**. The signals from the photoreceptors are then processed by a complex network of other retinal neurons. The final output is sent to the brain by the **retinal ganglion cells (RGCs)**, whose axons bundle together to form the optic nerve.

::: {#fig-eye-and-retina .figure}
::: {.panel-tabset}

### Eye Anatomy
![A cross-section of the human eye, showing the cornea, lens, iris, and retina.](images/human/02-encoding/2048px-3D_Medical_Animation_Eye_Structure.jpg){#fig-human-eyeball width="60%"}

### Retinal Location
![This diagram shows how the retina lines the back of the eyeball and highlights the fovea, the region of highest visual acuity.](images/human/02-encoding/retina-fovea-color.png){#fig-retina-color width="75%"}

:::
The two stages of visual encoding. Light is first focused by the eye's optics onto the retina, where it is converted into neural signals for the brain. Eye anatomy image source: [Scientific Animations](https://www.scientificanimations.com).
:::

A key feature of the retina is that it operates as a feed-forward system; there is no direct neural feedback from the brain to the retina. This simplifies our analysis, as we can study the retina's input-output relationship without accounting for top-down signals from other brain regions—a luxury not often afforded when studying the nervous system.

However, the brain also sends signals to the eye that control the size of the pupil and the optical power of the lens. The brain also provides an important indirect form of feedback by controlling eye, head, and body positions. These signals determine which part of the visual world is projected onto the retina. All of these signals are essential for seeing.

## Physiological optics
The cornea and the flexible lens work together to focus light, forming an image on the retina, as shown in @fig-physiological-optics. This optical system is dynamic, constantly adjusting both the amount of light it lets in and its focal point.

The amount of light entering the eye is controlled by the **pupil**, the aperture that can dilate (open) to about 8 mm in diameter in dim light or constrict (close) to about 2 mm in bright light. This change in area adjusts the light intake by a factor of about 16 (or 1.2 log units). While significant, this is a small adjustment compared to the vast range of light levels in the natural world, which can span over 10 log units. The pupil's size changes automatically in response to light, but it is also influenced by cognitive and emotional states, such as arousal or mental effort.


::: {#fig-physiological-optics .figure}
::: {.panel-tabset}

### Eyeball image

![Image of the physiological optics](images/human/02-encoding/eyeball-image.png){#fig-eyeball-image width="50%"}

### Eyeball sketch

![Schematic of the physiological optics](images/human/02-encoding/eyeball-sketch.png){#fig-eyeball-sketch width="50%"}
:::
The physiological optics of the human eye. The cornea provides most of the eye's fixed optical power, while the lens adjusts its shape to change focus.
:::

The eye changes its focus through a process called **accommodation**. Neural signals control the ciliary muscles, which are connected to the lens. To focus on distant objects, the ciliary muscles contract, which increases the diameter of the ring they form and pulls on the zonule fibers, flattening the lens. To focus on nearby objects, the muscles relax, allowing the lens to return to its natural, more rounded shape, which increases its optical power.

This remarkable flexibility is not permanent. With age, the lens gradually stiffens, reducing its ability to change shape. This condition, known as **presbyopia**, makes it difficult to focus on near objects. It typically becomes noticeable in one's early to mid-40s and is a natural part of aging, commonly corrected with reading glasses.  It happens to all of us.

<!-- 
https://commons.wikimedia.org/wiki/File:3D_Medical_Animation_Eye_Structure.jpg 
https://www.scientificanimations.com, CC BY-SA 4.0 <https://creativecommons.org/licenses/by-sa/4.0>, via Wikimedia Commons
-->

## Retina
Since the 1990s, vision scientists have been able to measure the quality of the physiological optics. In the sections below, I will summarize these measurements and the techniques that were invented to make them. I will also explain how to simulate how the incident light field is transformed into the retinal image using ISETBio. For me, it is important to understand these optics in terms of the photoreceptor sampling array. Knowing that an image is spread over 5 microns can mean one thing if the photoreceptors are sampled every 2 microns and something quite different if the photoreceptors are sampled every 10 microns. So before we talk about the physiological optics, let's consider the retina and particularly the photoreceptor mosaic.

The retina is approximately $200–300$ microns thick near the posterior pole, varying from about $100$ to $500$ microns across the retina. Its total area is on the order of $10–12~cm^2$. It is a laminated neural tissue comprising three nuclear layers separated by two plexiform layers. There are on the order of 80 different cell types that can be identified through their genetic expression, responses to light, and anatomical form. The retinal cells form stereotyped connections, which we call retinal circuits. We believe that there are about 20 such circuits. The circuit outputs, carried on the retinal ganglion cell axons in the optic nerve, project to a variety of locations in the brain.

The vast majority of light-driven activity is initiated in the photoreceptors (rods and cones). The rods are the dominant source under very low light levels, and the cones are the dominant source under moderate to high light levels. The typical retinal circuit is driven by activity that starts in a local region of the photoreceptors. The same basic circuit will be present throughout the retina, tiling the photoreceptor mosaic, though the absolute size of the cells and their input regions generally vary across the retina. The size of the region increases as one measures from the highly specialized central fovea into the periphery.

There is one important and interesting exception, only recently discovered. There exists a class of retinal ganglion cells that contain a light-sensitive pigment (melanopsin). These cells, called the intrinsically photosensitive RGCs (ipRGCs), absorb photons and respond to overall light level. There are not a lot of these cells, but their outputs are important for circadian rhythms and pupillary control. They may also influence other aspects of vision.

<!-- The Massey 2006 retinal anatomy paper has lots of great images.  Use that as a resource!  Some better than the ones here. -->

::: {#fig-physiological-optics .figure}
::: {.panel-tabset}

### Retinal layers
![This image shows the different layers of the retina very clearly. The different cell types are stained with different materials. Source: [New Scientist](https://www.newscientist.com/gallery/dn14971-small-world-gallery/)](images/human/02-encoding/retina-ej.png){#fig-retina-ej width="50%"}

### Five retinal cell types
![This sketch illustrates the different cell types and how they form specific circuits. The five principal cell types are illustrated. Source: Rodieck](images/human/02-encoding/retina-rodieck.png){#fig-retina-rodieck width="70%"}

### Peripheral retinal layers
![This Differential Interference Contrast (DIC) microscopy image gives a sense of the density and interconnectedness of the different retinal layers and cells. It may also make it clear why it is such an accomplishment that scientists have painstakingly identified individual cell types and their circuits. Source:  @massey2006-retinalanatomy](images/human/02-encoding/retina-massey.png){width="90%"}

### Fovea 
![The primate retina—but not all retinas—has a very important specialization: the fovea. This is a cone-dominated region; inner retinal layers are laterally displaced, creating a pit and enabling very high acuity. GCL: Ganglion cell layer. INL: Inner nuclear layer (sometimes labeled “bipolar layer” in schematics). REC/PR: Photoreceptors. RPE: Retinal pigment epithelium. Source: I have had this forever. I have searched for the source. Better image from Massey paper, maybe.](images/human/02-encoding/retina-fovea.png){#fig-retina-fovea width="80%"}
:::
A variety of ways of visualizing and characterizing the retina.
:::

<!-- 
DIC optics refers to **Differential Interference Contrast microscopy**.

It's a type of optical microscopy technique that enhances the contrast in unstained, transparent specimens, like the layers of a retina, by making features visible that would otherwise be nearly invisible in a brightfield microscope.

### How DIC Optics Work

DIC microscopy converts gradients in specimen thickness or refractive index (which naturally occur at the boundaries of structures like cell layers, membranes, and organelles) into differences in light intensity (contrast) that the human eye or a camera can detect.

1.  **Light Manipulation:** It uses specialized optical components, primarily **polarizers** and **Nomarski prisms** (or Wollaston prisms), to split a single beam of light into two beams that are slightly offset from each other.
2.  **Phase Shift:** These two beams pass through adjacent regions of the specimen. Since the specimen has a varying refractive index (e.g., one beam passes through a cell membrane, the other through the surrounding cytoplasm), the light waves emerge with a slight **phase difference**.
3.  **Interference:** The beams are then recombined. Due to the phase difference, they **interfere** with each other. This interference creates a high-contrast, pseudo-three-dimensional relief image, making structures like the cell layers and fine details mentioned in the caption (e.g., cone pedicles) much more distinct and easier to observe without the need for staining. 

In the context of the figure caption, using DIC optics allowed the researchers to clearly delineate the layered structure of the macaque retina—the **plexiform layers** and the **nuclear layers (ONL, INL, ganglion cell layer)**—in a fresh or relatively unstained preparation.
-->

## The optical image {#sec-optical-image}
In the late 1990s, it became possible to measure how the physiological optics blurs the light in the living human eye.  The key technology for making this measurement is called **adaptive optics**, and it is based on a measurement device called the **Shack-Hartmann (S-H) wavefront sensor**. This technology, originally developed by astronomers pointing their telescopes at the stars, measures the blurring (wavefront distortion) by the optical system. 

The principle of the measurement is illustrated in @fig-wavefront-aberrometer. A narrow beam of light is directed through the center of the pupil. Some of the light is reflected from the retina, at the layer between the inner and outer segements of the receptors. The reflected light is Lambertian (spread in all directions) and fills up the lens as it passes back through the optics. If the optics were perfect, the rays exiting the eye from the small spot would be close to collimated and the wavefront would be a constant. But the rays are not parallel and thus the wavefront has some deviations from constant. These are aberrations that we measure at the S-H wavefront sensor. 

![Wavefront measurement.  ](images/human/02-encoding/wavefront-aberrometer.png){#fig-wavefront-aberrometer width="60%"}

We use the S-H wavefront sensor to measure the distortion introduced by the optics of the eye. Once we know the wavefront distortion, we can send in an image whose rays are compensated for this distortion.  These pre-distorted rays pass through the optics, and the effect of the wavefront aberrations is to cause the reflected rays to be collimated and thus the image is diffraction limited.  When the pupil aperture is fairly large, say 7 mm diameter, the Airy disk will be

<!--
My chatgpt conversation about AO and AOSLO imaging. This book should have a short form of that.  A longer explanation can go into FOV 2nd ed.

https://chatgpt.com/share/690926d6-4d98-8002-b395-5e93bb3f900a
-->

These double-pass measurements (light goes in through the optics and then back out)

### Shack–Hartmann wavefront sensor {#sec-wavefront-sensor}

Johannes Franz Hartmann was a German astronomer working on the problem of detecting optical defects in telescope objectives. Reasoning from the ray theory of light, he measured the optical light field from a simple stimulus: an on-axis point at the focal length of the lens. In principle, the rays emerging from an ideal lens would all be parallel to the main axis. To look for deviations, he created a screen comprising an array of pinholes. If the rays were parallel, the light through the pinhole would be nicely centered behind the pinhole. If the rays were not quite parallel, the image behind the pinhole would be displaced by some distance and amount from the center. The deviations could be considered defects in the lens that could be corrected.

As I observed above, the image behind each pinhole measures the intensity of the rays incident at different angles. But in practice, a small pinhole produces a blurry spot due to diffraction. Thus Hartmann did not try to extract an image but he just estimated the central position of the blurry spot. Also, because the pinholes only let through a small amount of light, the technique was not very sensitive.

Because there is an array of these pinholes, the accumulation of pinhole images measures the rays at multiple angles at multiple positions. In principle, by performing this measurement for different wavelengths and polarizations, we sample the optical light field (@eq-lightfield-optical).

<!--
The Raskar version in which you put spots behind the lenslet array and adjust the spots to make the array uniform is kind of funny.  It is intended to measure the optical aberrations of the eye
https://en.wikipedia.org/wiki/Shack%E2%80%93Hartmann_wavefront_sensor
-->


[Arizona History of the Shack work.](https://www.optics.arizona.edu/sites/default/files/2022-07/Historical-Development-Shack-Hartman-Wavefront-Sensor.pdf?utm_source=chatgpt.com)

### PSF measurements
New section to describe

## Photoreceptor types
The rod and cone photoreceptors are specialized neurons whose principal function is to convert electromagnetic radiation into a neural signal. Both types of photoreceptors accomplish this using a light-sensitive pigment (photopigment). This pigment absorbs photons and, in so doing, initiates a chain reaction of events within the cell (@stryer1986-annrev). These events, the transduction cascade, result in a change in the synaptic signal from the photoreceptor. The spatio-temporal pattern of changes across the photoreceptor mosaic is the signal that the nervous system interprets and the basis of our sight.

The arrows at the bottom indicate the direction of the incoming light (the lens is below). The light arrives at the photoreceptor layer, brought into focus by the physiological optics. Some of the light enters the cell through the inner-segment aperture. Because of the refractive-index contrast between the inner segment and surrounding medium, the inner segment acts as a waveguide that directs the light toward the outer segment, where it initiates the transduction cascade. 

<!-- These folks think that the mitochondria act as microlenses to guide the light within the cone photoreceptors (@ball2022-cones-microlens). -->

::: {#fig-photoreceptors .figure}
::: {.panel-tabset}
### Simple rod and cone
![Denis Baylor's Proctor Medal award included this very simple diagram, which he entitled 'A physiologist’s diagram of a rod and cone.' The horizontal lines show the stacks of photosensitive pigment molecules within the outer segment of these cells. The arrangement differs between the rods and cones. In the rods, the photopigment is mainly contained in discs (saccules) that are not continuous with the cell’s surface membrane. In the cones, the photosensitive membrane is continuous with the cell surface. The absorption of a photon initiates a series of events (transduction cascade) that modulates the membrane potential and the rate of synaptic transmitter release. The transmitter itself is packaged in synaptic vesicles, shown by the circles. Source: @baylorPhotoreceptorSignalsVision1987](images/human/02-encoding/photoreceptor-baylor.png){#fig-photoreceptor-baylor width="50%"}

### Detailed rod and cone
![Cote’s review article paints a more detailed picture of the anatomical and functional elements of the rod and cone receptors. Source: @cote2006-photoreceptor, Fig 8.1](images/human/02-encoding/photoreceptor-cote.png){#fig-photoreceptor-anatomy width="50%"}
:::
The photoreceptors capture light. The light enters the photoreceptor through the inner segment and is absorbed by the photosensitive molecules in the outer segment. </figcaption>
:::

The rod and cone photoreceptors are two largely distinct systems. The rods are mainly used to provide vision under low light levels (scotopic; e.g., nighttime). There is only one type of rod photopigment, rhodopsin. For this reason the rod system provides no information to compare the different wavelengths of light incident at the retina.

The cone photoreceptors dominate vision at modest to high levels of illumination. There are three types of cones, containing three different photopigments. These photopigments absorb over a fairly broad wavelength band, but they have different peak sensitivities in the long-, middle-, and short-wavelength parts of the visible spectrum. I will cover more on this in the color section below.

The spatial resolution of the human eye depends on the aperture size and spacing of the photoreceptor inner segments, particularly for the cones. A great deal was discovered about the sampling mosaic in the 1980s and 1990s @curcioHumanPhotoreceptorTopography1990. Prior to that time, the nature of the cone sampling mosaic and the importance of sampling were not widely appreciated. The importance of sampling was emphasized by Yellott and colleagues, who analyzed the spatial sampling. William Miller and Joy Hirsch, at Yale, were among the first to crisply show the dense packing (@miller1987-conesampling). Over small patches of the primate retina the packing is quite dense (@fig-inner-segment-miller), in a spatial arrangement called a triangular (hexagonal) packing.

![Cone inner segment spatial sampling. Source: @miller1987-conesampling (personal communication)](images/human/02-encoding/inner-segments-foveal.png){#fig-inner-segment-miller width="50%"}

How does the spatial sampling of the cones compare to the optical PSF? One comparison we can make is for the central fovea. There the inner-segment apertures are about 1.5–2 microns in diameter. Using ISETCam we can calculate the diffraction-limited Airy disk diameter (first minimum) for a 550 nm light. For a 3 mm pupil, the f-number of the human optics is 17 mm / 3 mm ≈ 5.6. Using @eq-airydisk1, this is:

```
>> radius = airyDisk(550,5.6,'units','um','diameter',true)
radius =
    7.5152
```

This calculation shows that a tiny point in the scene -say star light- will be spread over a diameter of about 7 $\mu\text{m}$ on the retinal surface, which corresponds to a 3 or 4 foveal cones. In natural vision, therefore, no stimulus will excite a single photoreceptor; the nervous system always receives signals from multiple cones, even if it draws the inference that the source is a single, very tiny point of light.

One reason for creating such a system that spreads the light over several cones may be to enable us to judge the wavelength information. It is likely that spreading the light across 5-10 cones will engage cones with more than one type of photopigment, and the relative excitation of the different types of cones is the signal we use to judge color.  We encountered a similar principle when describing the color filter array in cameras; designers purposefully introduced some blur so that any small region of the scene would engage the R,G and B pixels (@sec-sensor-cfa). 

What is the arrangement of the different cone types in the human eye? Some data on this point emerged in the 1980s and 1990s when biologists discovered fluorescent markers that would attach to just one type of photoreceptor (@demonasterio1981-scones, @demonasterio1985-scones @wikler1990-photoreceptor-subtypes).  These measurements could distinguish the L,M cones from the S-cones.

::: {#fig-cone-type-sampling .figure}
::: {.panel-tabset}
### Cone types
![L,M cone types, intermixed with rods, and some S-cone hints.  Lots of rods.  Near periphery. Source: @wikler1990-photoreceptor-subtypes](images/human/02-encoding/s-cone-sampling.png){#fig-scones-wikley width="60%"}

### S-cones sampling
![S-cone procion yellow staining from de Monasterio and Schein.  Source @demonasterio1981-scones see also @demonasterio1985-scones  ](images/human/02-encoding/scones-schein.png){#fig-scones-schein width="60%"}
:::
Cone mosaics of the different cone types are interleaved.  The L and M cone mosaics are interleaved approximately randomly at high resolution. The S-cone mosaic samples the image much more coarsely, and it is relatively more uniform.
:::

About ten years later, new estimates that could distinguish between the L- from M-cones were obtained in the living human eye. These measurements used adaptive optics coupled with knowledge about the relative wavelength selectivity of the different cone types (@roorda1999-conetypes, @hofer2005-cone-mosaic, @hofer2014-retinalmosaic). I explain these measurements in the Foundations of Vision, 2nd edition.  When that gets written. 

![Source:@hofer2005-cone-mosaic, Figure 4](images/human/02-encoding/hofer2005.png){#fig-hofer-mosaic width="70%"}

These measurements revealed something that was quite surprising to vision scientists.  The ratio of L- to M- cones in the living human eye is quite variable, from person to person. Some individuals have equal numbers of L- and M- cones, while others have a large predominance of L-cones. To this point in time, we have not learned how to reveal these differences in behavioral experiments, although there have been some attempts. I suspect that an enterprising engineer or scientist will find a means to do so in the future. One of the reasons that the difference is hard to reveal is that the L- and M-cones are so similar to one another.

## Cone mosaic at different eccentricities
The cone density and the aperture size of the inner segment varies a great deal as we measure from the fovea to the periphery. The inner segment aperture diameters in the central fovea are very small (1-2 microns) and tightly packed.  The apertures in the periphery become as large as 8light field sampling function is very different from the fovea to the periphery (@fig-cone-mosaic-density).

::: {#fig-cone-mosaic-density .figure}
::: {.panel-tabset}
### Fovea
![A 1x1 deg patch centered on the fovea. Notice that there are no S-cones in the very center and no rods throughout.](images/human/02-encoding/coneMosaic-0-deg.svg){#fig-mosaic-0 width="70%"}

### 3 deg
![A 1x1 deg patch at 3 deg eccentricity.  The inner segment apertures have increased in size. S-cones are present, but few rods.](images/human/02-encoding/coneMosaic-3-deg.svg){#fig-mosaic-3 width="70%"}

### 6 deg
![A 1x1 deg patch at 6 deg eccentricity. Even larger apertures. More rods.](images/human/02-encoding/coneMosaic-6-deg.svg){#fig-mosaic-6 width="70%"}

<!--![](images/human/02-encoding/coneMosaic-6-deg.svg){fig-cap="Cone inner-segment apertures from fovea to periphery" fig-cap-location=margin width="0.5\\textwidth"}-->
<!-- ![](images/human/02-encoding/coneMosaic-6-deg.svg){fig-cap="Cone inner-segment apertures from fovea to periphery" fig-cap-location=bottom width="0.5\\textwidth"}-->

### 12 deg
![A 1x1 deg patch at 12 deg eccentricity. Aperture size is increased to XX microns. Lots of space for the rods between the cones. ](images/human/02-encoding/coneMosaic-12-deg.svg){#fig-mosaic-12 width="70%"}
:::
ISETBio simulations of the cone sampling mosaic at four different eccentricities. Source: fise_humanMosaic.m
:::



<!-- See fise_humanConePSF.m in code/human -->
## PSF at the cone inner segments
We are ready to describe the optical spread with respect to the cone mosaic image. We needed the retina and the photoreceptor sampling mosaic defined so we could make sense of the whole system.

### Eccentricity dependence

Artal data. Point to ISETBio and maybe the other book.

::: {#fig-cone-psf- .figure}
::: {.panel-tabset}
### Fovea
![Mumble.](images/human/02-encoding/conePSF-0-deg.svg){#fig-mosaic-0 width="70%"}

### 3 deg
![Fix.](images/human/02-encoding/conePSF-3-deg.svg){#fig-mosaic-3 width="70%"}

### 6 deg
![Fix.](images/human/02-encoding/conePSF-6-deg.svg){#fig-mosaic-6 width="70%"}

### 12 deg
![Fix.](images/human/02-encoding/conePSF-12-deg.svg){#fig-mosaic-12 width="70%"}
:::
ISETBio simulations of the PSF superimposed on the cone sampling mosaic at four different eccentricities. For an example subject based on Artal optics measurements. Source: fise_humanOpticsPSFm
:::

### Wavelength dependence

The short wavelength light is focused at the RGC layer when the middle wavelengths are in good focus at the inner segment.

<!-- See fise_humanConePSF.m in code/human -->
::: {#fig-cone-psf-wavelength .figure}
:::{.panel-tabset}
### PSF for 550nm
![PSF at 3 deg:  550nm](images/human/02-encoding/conePSF-550.svg){#fig-psf-550nm width="60%"}

### PSF for 480nm
![PSF at 3 deg:  480nm](images/human/02-encoding/conePSF-480.svg){#fig-psf-480nm width="60%"}
:::
Point spread function for different wavelengths, superimposed on the foveal sampling mosaic. (Source:  fise_humanConePSF.m)
:::

## Modulation Transfer function 


::: {.callout-note title="Astronomy and adaptive optics"}

### Ground-based telescopes {#sec-telescopes}

These same technologies can be used to look inward, within the eye, rather than outward toward the stars. Realizing this was a very important insight that continues to lead to important insights about the peripheral human visual system (@sec-human-seeing-overview).

### Adaptive optics {#sec-adaptive-optics}
Where should the adaptive optics measurement method be? Here or FOV? Adaptive optics measurements of wavefront aberrations, expressed as point spread functions. Thibos and Artal data.

The ability to measure certain properties of the optics was revolutionized by adpative optics - a method that makes real time measurements of the wavefront aberrations of the physiological optics using a Shack-Hartmann wavefront sensor. Just the measurement of the aberrations alone is useful. In addition, it has proben possible to engineer systems that correct for these aberrations in real time, and thus visualize the apertures of the photoreceptors (1-5 $\mu \text{m}$ diameter) cells in the retina. Further, using video tracking of the eye movements it has proven possible to deliver stimuli to specific, targeted photoreceptors.

First order approximations of the human optics. Simulations with ISETBio of maybe the Westheimer or Ijspeert functions. Eye models?

:::
