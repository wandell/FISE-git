<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2025-11-23">
<meta name="description" content="An integrated overview of image systems, from physical scene formation through sensors, optics, and human vision.">

<title>22&nbsp; Human spatial encoding – Foundations of Image Systems Engineering</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/human-03-wavelength-encoding.html" rel="next">
<link href="../chapters/human-01-seeing.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles/hover.css">
<link rel="stylesheet" href="../styles/callouts.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/part-human.html">Human</a></li><li class="breadcrumb-item"><a href="../chapters/human-02-spatial-encoding.html"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Human spatial encoding</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Foundations of Image Systems Engineering</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Preface</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Scenes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/part-scenes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part I: Scenes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/lightfields-01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Light and seeing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/lightfields-02-measurement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Measuring light</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/lightfields-03-properties.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Light field properties</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/lightfields-04-properties-spectral.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Spectral regularities</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/lightfields-05-properties-spatial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Spatial regularities</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Optics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/part-optics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part II: Optics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/optics-01-geometric.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Geometric optics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/optics-02-lenses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Lens principles</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/optics-03-thinlens.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Thin lenses</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/optics-04-morelenses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Lenses and ray transfer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/optics-05-linear-space.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Spatial domain</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/optics-06-linear-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Transform domain</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/optics-07-wavefront.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Wavefronts</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Sensors</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/part-sensors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part III: Sensors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/sensors-01-photoelectric.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Photons and Electrons</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/sensors-02-pixels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Pixels and sensors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/sensors-03-parameters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Sensor parameters</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/sensors-04-components.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">System components</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/sensors-05-control.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Control systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/sensors-06-characterization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Image system modeling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/sensors-07-innovations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Sensor innovations</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Human</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/part-human.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part IV: Human Vision</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/human-01-seeing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Seeing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/human-02-spatial-encoding.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Human spatial encoding</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/human-03-wavelength-encoding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Human wavelength encoding</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/human-04-metrics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Human visual metrics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Displays</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/part-displays.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part V: Displays</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/displays-01-principles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Display Principles</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Image processing</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/part-processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part VI: Image processing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/imgprocessing-01-hardware.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Hardware processing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/imgprocessing-02-rendering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Rendering</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendix</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/part-appendix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part VII: Appendix</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/appendix-01-linearsystems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Linear systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/appendix-02-spaceinvariance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Linear Space-Invariant (LSI) Systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/appendix-03-isetcam.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Image Systems Simulation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-human-spatial-encoding-overview" id="toc-sec-human-spatial-encoding-overview" class="nav-link active" data-scroll-target="#sec-human-spatial-encoding-overview"><span class="header-section-number">22.1</span> Human spatial encoding overview</a></li>
  <li><a href="#sec-human-encoding-systems" id="toc-sec-human-encoding-systems" class="nav-link" data-scroll-target="#sec-human-encoding-systems"><span class="header-section-number">22.2</span> The Two Stages of Encoding</a></li>
  <li><a href="#physiological-optics" id="toc-physiological-optics" class="nav-link" data-scroll-target="#physiological-optics"><span class="header-section-number">22.3</span> Physiological optics</a></li>
  <li><a href="#retina" id="toc-retina" class="nav-link" data-scroll-target="#retina"><span class="header-section-number">22.4</span> Retina</a></li>
  <li><a href="#sec-adaptive-optics" id="toc-sec-adaptive-optics" class="nav-link" data-scroll-target="#sec-adaptive-optics"><span class="header-section-number">22.5</span> Adaptive optics</a></li>
  <li><a href="#photoreceptor-types" id="toc-photoreceptor-types" class="nav-link" data-scroll-target="#photoreceptor-types"><span class="header-section-number">22.6</span> Photoreceptor types</a></li>
  <li><a href="#cone-mosaic-at-different-eccentricities" id="toc-cone-mosaic-at-different-eccentricities" class="nav-link" data-scroll-target="#cone-mosaic-at-different-eccentricities"><span class="header-section-number">22.7</span> Cone mosaic at different eccentricities</a></li>
  <li><a href="#psf-at-the-cone-inner-segments" id="toc-psf-at-the-cone-inner-segments" class="nav-link" data-scroll-target="#psf-at-the-cone-inner-segments"><span class="header-section-number">22.8</span> PSF at the cone inner segments</a>
  <ul class="collapse">
  <li><a href="#eccentricity-dependence" id="toc-eccentricity-dependence" class="nav-link" data-scroll-target="#eccentricity-dependence"><span class="header-section-number">22.8.1</span> Eccentricity dependence</a></li>
  <li><a href="#psf-wavelength-dependence" id="toc-psf-wavelength-dependence" class="nav-link" data-scroll-target="#psf-wavelength-dependence"><span class="header-section-number">22.8.2</span> PSF wavelength dependence</a></li>
  </ul></li>
  <li><a href="#spatial-sensitivity-in-the-transform-domain" id="toc-spatial-sensitivity-in-the-transform-domain" class="nav-link" data-scroll-target="#spatial-sensitivity-in-the-transform-domain"><span class="header-section-number">22.9</span> Spatial sensitivity in the transform domain</a>
  <ul class="collapse">
  <li><a href="#sec-contrast-sensitivity" id="toc-sec-contrast-sensitivity" class="nav-link" data-scroll-target="#sec-contrast-sensitivity"><span class="header-section-number">22.9.1</span> Contrast sensitivity functions (CSF)</a></li>
  <li><a href="#vernier-acuity" id="toc-vernier-acuity" class="nav-link" data-scroll-target="#vernier-acuity"><span class="header-section-number">22.9.2</span> Vernier acuity</a></li>
  </ul></li>
  <li><a href="#todo" id="toc-todo" class="nav-link" data-scroll-target="#todo"><span class="header-section-number">22.10</span> TODO</a>
  <ul class="collapse">
  <li><a href="#sec-telescopes" id="toc-sec-telescopes" class="nav-link" data-scroll-target="#sec-telescopes"><span class="header-section-number">22.10.1</span> Ground-based telescopes</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/part-human.html">Human</a></li><li class="breadcrumb-item"><a href="../chapters/human-02-spatial-encoding.html"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Human spatial encoding</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-human-spatial-encoding" class="quarto-section-identifier"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Human spatial encoding</span></span></h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 23, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Work in Progress
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>The book is still taking shape, and your feedback is an important part of the process. Suggestions of all kinds are welcome—whether it’s fixing small errors, raising bigger questions, or offering new perspectives. I’ll do my best to respond, but please keep in mind that the text will continue to change significantly over the next two years.</p>
<p>You can share comments through <a href="https://github.com/wandell/FISE-git/issues" target="_blank">GitHub Issues</a>.</p>
<p>Feel free to open a new issue or join an existing discussion. To make feedback easier to address, please point to the section you have in mind—by section number or a short snippet of text. Adding a label characterizing your issue would also be helpful.</p>
<p>Last updated: November 23, 2025</p>
</div>
</div>
</div>
<!--
# The chapters with David have a lot of the material for this chapter.
-->
<p>The material about human vision in this chapter is under development.</p>
<p>Please refer to the chapters in <a href="https://foundationsofvision.stanford.edu" target="_blank">Foundations of Vision</a>.</p>
<ul>
<li><a href="https://wandell.github.io/FOV-1995/chapter-5-the-retinal-representation.html" target="_blank">Retina</a></li>
<li><a href="https://wandell.github.io/FOV-1995/chapter-7-pattern-sensitivity.html" target="_blank">Pattern sensitivity</a></li>
</ul>
<section id="sec-human-spatial-encoding-overview" class="level2" data-number="22.1">
<h2 data-number="22.1" class="anchored" data-anchor-id="sec-human-spatial-encoding-overview"><span class="header-section-number">22.1</span> Human spatial encoding overview</h2>
<p>The image systems components we studied in earlier chapters have a structure that has an input and an output. This makes it possible to characterize these systems using transfer functions, such as the OTF and pointspread. The human visual system does not have an output that we can measure directly; the percepts we experience are private. Consequently vision science has relied on a wide variety of measurements, some direct and some indirect, to make inferences about the neural processing that underlies human perception.</p>
<p>In the first part of this chapter, I review how blurring by the optics and sampling by the photoreceptors limits the spatial resolution. These measurements characterize only the first steps in seeing, but they are important because they represent a bottleneck. Spatial information that is not captured by the eye can only be guessed at by the brain.</p>
<p>There is more information available in the cone photoreceptor array than we effectively process. The neural processing strategies that interpret the image do not aim to use every scrap of available information. This gap is of interest, of course, for image systems engineers who are interested in predicting human perception, such as perceived image quality. Information about the spatial resolution of human performance must come from measures of this performance. Some of these measurements are amenable to quantification and they can be used to create quantitative engineering metrics (e.g., Barten’s model).</p>
<p>There are many other measurements that are useful for revealing the principles implemented in the neural processing, but not immediately applicable to image systems evaluation or design. The material in this section describes measurements that are relevant to engineering metrics, and the material in <a href="https://foundationsofvision.stanford.edu" target="_blank">Foundations of Vision</a> includes many more measurements that are helpful for understanding the general processing strategies.</p>
</section>
<section id="sec-human-encoding-systems" class="level2" data-number="22.2">
<h2 data-number="22.2" class="anchored" data-anchor-id="sec-human-encoding-systems"><span class="header-section-number">22.2</span> The Two Stages of Encoding</h2>
<p>Two systems in the eye function together to convert electromagnetic radiation from the scene into a neural signal that the brain interprets (<a href="#fig-eye-and-retina" class="quarto-xref">Figure&nbsp;<span>22.1</span></a>).</p>
<p>First, the <strong>physiological optics</strong>—the cornea and lens—act like a camera lens. The optics gathers the radiation entering the eye and focuses it to form an image on the retina. This optical system transforms the radiation from the environment into a focused optical image.</p>
<p>Second, the <strong>retina</strong>, a thin layer of neural tissue lining the back of the eye, contains a set of highly specialized neurons that convert this optical image into neural signals. This process, called transduction, is performed by the <strong>photoreceptors</strong>. The signals from the photoreceptors, in the form of synaptic transmitter release, are processed by several distinct networks of retinal neurons. The output of these networks is sent to the brain on the axons of the <strong>retinal ganglion cells (RGCs)</strong>. The bundle of RGC axons exit the retina through a small hole and form the optic nerve.</p>
<div id="fig-eye-and-retina" class="figure quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-eye-and-retina-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Eye Anatomy</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Retinal Location</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div id="fig-human-eyeball" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-human-eyeball-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/human/02-spatial-encoding/2048px-3D_Medical_Animation_Eye_Structure.jpg" class="img-fluid figure-img" style="width:60.0%" data-ref-parent="fig-eye-and-retina">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-human-eyeball-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) A cross-section of the human eye, showing the cornea, lens, iris, and retina.
</figcaption>
</figure>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div id="fig-retina-color" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-retina-color-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/human/02-spatial-encoding/retina-fovea-color.png" class="img-fluid figure-img" style="width:75.0%" data-ref-parent="fig-eye-and-retina">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-retina-color-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) This diagram shows how the retina lines the back of the eyeball and highlights the fovea, the region of highest visual acuity.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-eye-and-retina-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;22.1: The two systems of the visual encoding. Radiation is focused by the optics onto the photoreceptor layer of the retina. These specialized neurons, which are sensitive to some wavelengths but not others, convert the radiation into neural signals. We call the radiation that the eye converts into a neural signal <em>light</em>. Source: Eye anatomy: <a href="https://www.scientificanimations.com">Scientific Animations</a>.
</figcaption>
</figure>
</div>
<p>The retina is a feed-forward system; there is no direct neural feedback from the brain. This simplifies our work, allowing us to study the retina’s input-output relationship without accounting for top-down signals—a luxury we rarely have when studying other parts of the brain.</p>
<p>However, the brain does send signals to the eye that control pupil size and lens power. It also controls eye, head, and body positions, determining which part of the visual world falls on the retina. These signals do not reach the retinal neurons directly, but they are essential for seeing.</p>
</section>
<section id="physiological-optics" class="level2" data-number="22.3">
<h2 data-number="22.3" class="anchored" data-anchor-id="physiological-optics"><span class="header-section-number">22.3</span> Physiological optics</h2>
<p>The cornea and the flexible lens work together to focus light, forming an image on the retina, as shown in <a href="#fig-physiological-optics" class="quarto-xref">Figure&nbsp;<span>22.3</span></a>. This optical system is dynamic, constantly adjusting both the amount of light it lets in and its focal length.</p>
<p>The amount of light entering the eye is controlled by the <strong>pupil</strong>, an aperture that can dilate (open) to about 8 mm in diameter in dim light or constrict (close) to about 2 mm in bright light. This change in area adjusts the light intake by a factor of about 16 (or 1.2 log units). While significant, this is a small adjustment compared to the vast range of light levels we encounter in nature, which can span as much as 10 log units across a single day. The pupil’s size changes automatically in response to light, but it is also influenced by cognitive and emotional states, such as arousal or mental effort.</p>
<p>The pupil size also determines which part of the cornea and lens contributes to image formation. When the pupil is constricted, the image is formed using only a relatively small central part of the cornea and lens. Under these conditions, optical aberrations are minimized, and the image quality can be very high, sometimes approaching the diffraction limit. When the pupil is wide open, a much larger region of the cornea and lens is used. Because biological optics are not perfect, aberrations become more significant, and the image quality is far from diffraction-limited.</p>
<div id="fig-physiological-optics" class="figure quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-physiological-optics-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Eyeball image</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Eyeball sketch</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div id="fig-eyeball-image" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-eyeball-image-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/human/02-spatial-encoding/eyeball-image.png" class="img-fluid figure-img" style="width:50.0%" data-ref-parent="fig-physiological-optics">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-eyeball-image-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Image of the physiological optics
</figcaption>
</figure>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div id="fig-eyeball-sketch" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-eyeball-sketch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/human/02-spatial-encoding/eyeball-sketch.png" class="img-fluid figure-img" style="width:50.0%" data-ref-parent="fig-physiological-optics">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-eyeball-sketch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Schematic of the physiological optics
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-physiological-optics-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;22.2: The physiological optics of the human eye. The cornea provides most of the eye’s fixed optical power. The lens adjusts its shape and optical power, which changes the in-focus plane.
</figcaption>
</figure>
</div>
<p>The eye changes the object plane that is in focus through a process called <strong>accommodation</strong>. Neural signals control the ciliary muscles, which are connected to the lens by the zonule fibers. To focus on nearby objects, the ciliary muscles contract. This contraction reduces the diameter of the ring they form, relaxing the tension on the zonule fibers. This allows the elastic lens to become more rounded (convex), increasing its optical power. To focus on distant objects, the ciliary muscles relax. This increases the diameter of the ring, which pulls on the zonule fibers and flattens the lens, decreasing its optical power.</p>
<p>This lens flexibility is not permanent. With age, the lens gradually stiffens, reducing its ability to change shape. This condition, known as <strong>presbyopia</strong>, makes it difficult for older people to focus on near objects. The loss of near-field visual acuity typically becomes noticeable in one’s early to mid-40s and is a natural part of aging, commonly corrected with reading glasses. It happens to all of us.</p>
<!-- 
https://commons.wikimedia.org/wiki/File:3D_Medical_Animation_Eye_Structure.jpg 
https://www.scientificanimations.com, CC BY-SA 4.0 <https://creativecommons.org/licenses/by-sa/4.0>, via Wikimedia Commons
-->
</section>
<section id="retina" class="level2" data-number="22.4">
<h2 data-number="22.4" class="anchored" data-anchor-id="retina"><span class="header-section-number">22.4</span> Retina</h2>
<p>Since the 1990s, vision scientists have been able to measure the quality of the physiological optics. Below, I describe the techniques invented to make these measurements. The Appendix explains how we use these measurements and ISETBio to simulate the transformation of the incident light field into the retinal image.</p>
<p>It is important to understand these optics in terms of the photoreceptor sampling array. A 5-micron optical spread has different implications if sampled every 2 microns versus every 10 microns. Thus, before discussing physiological optics, we consider the retina and the photoreceptor mosaic.</p>
<p>The retina is approximately <span class="math inline">\(200–300\)</span> microns thick near the posterior pole, varying from about <span class="math inline">\(100\)</span> to <span class="math inline">\(500\)</span> microns across the retina. Its total area is on the order of <span class="math inline">\(10–12~cm^2\)</span>. It is a laminated neural tissue comprising three nuclear layers separated by two plexiform layers. There are on the order of 80 different cell types that can be identified through their genetic expression, responses to light, and anatomical form. The retinal cells form stereotyped connections, which we call retinal circuits. We believe that there are about 20 such circuits. The circuit outputs, carried on the retinal ganglion cell axons in the optic nerve, project to a variety of locations in the brain.</p>
<p>The vast majority of light-driven activity is initiated in the photoreceptors (rods and cones). The rods are the dominant source under very low light levels, and the cones are the dominant source under moderate to high light levels. The typical retinal circuit is driven by activity that starts in a local region of the photoreceptors. The same basic circuit will be present throughout the retina, tiling the photoreceptor mosaic, though the absolute size of the cells and their input regions generally vary across the retina. The size of the region increases as one measures from the highly specialized central fovea into the periphery.</p>
<p>There is one important and interesting exception, only recently discovered. There exists a class of retinal ganglion cells that contain a light-sensitive pigment (melanopsin). These cells, called the intrinsically photosensitive RGCs (ipRGCs), absorb photons and respond to overall light level. There are not a lot of these cells, but their outputs are important for circadian rhythms and pupillary control. They may also influence other aspects of vision.</p>
<!-- The Massey 2006 retinal anatomy paper has lots of great images.  Use that as a resource!  Some better than the ones here. -->
<div id="fig-physiological-optics" class="figure quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-physiological-optics-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Retinal layers</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Five retinal cell types</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Peripheral retinal layers</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">Fovea</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div id="fig-retina-ej" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-retina-ej-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/human/02-spatial-encoding/retina-ej.png" class="img-fluid figure-img" style="width:50.0%" data-ref-parent="fig-physiological-optics">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-retina-ej-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) This image shows the different layers of the retina very clearly. The different cell types are stained with different materials. Source: <a href="https://www.newscientist.com/gallery/dn14971-small-world-gallery/">New Scientist</a>
</figcaption>
</figure>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div id="fig-retina-rodieck" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-retina-rodieck-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/human/02-spatial-encoding/retina-rodieck.png" class="img-fluid figure-img" style="width:70.0%" data-ref-parent="fig-physiological-optics">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-retina-rodieck-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) This sketch illustrates the different cell types and how they form specific circuits. The five principal cell types are illustrated. Source: Rodieck
</figcaption>
</figure>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/human/02-spatial-encoding/retina-massey.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption>This Differential Interference Contrast (DIC) microscopy<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> image gives a sense of the density and interconnectedness of the different retinal layers and cells. It may also make it clear why it is such an accomplishment that scientists have painstakingly identified individual cell types and their circuits. Source: <span class="citation" data-cites="massey2006-retinalanatomy">Massey (<a href="references.html#ref-massey2006-retinalanatomy" role="doc-biblioref">2006</a>)</span></figcaption>
</figure>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<div id="fig-retina-fovea" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-retina-fovea-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/human/02-spatial-encoding/retina-fovea.png" class="img-fluid figure-img" style="width:80.0%" data-ref-parent="fig-physiological-optics">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-retina-fovea-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) The primate retina—but not all retinas—has a very important specialization: the fovea. This is a cone-dominated region; inner retinal layers are laterally displaced, creating a pit and enabling very high acuity. GCL: Ganglion cell layer. INL: Inner nuclear layer (sometimes labeled “bipolar layer” in schematics). REC/PR: Photoreceptors. RPE: Retinal pigment epithelium. Source: I have had this forever. I have searched for the source. Better image from Massey paper, maybe.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-physiological-optics-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;22.3: A variety of ways of visualizing and characterizing the retina.
</figcaption>
</figure>
</div>
<!--
### How DIC Optics Work

1.  **Light Manipulation:** It uses specialized optical components, primarily **polarizers** and **Nomarski prisms** (or Wollaston prisms), to split a single beam of light into two beams that are slightly offset from each other.
2.  **Phase Shift:** These two beams pass through adjacent regions of the specimen. Since the specimen has a varying refractive index (e.g., one beam passes through a cell membrane, the other through the surrounding cytoplasm), the light waves emerge with a slight **phase difference**.
3.  **Interference:** The beams are then recombined. Due to the phase difference, they **interfere** with each other. This interference creates a high-contrast, pseudo-three-dimensional relief image, making structures like the cell layers and fine details mentioned in the caption (e.g., cone pedicles) much more distinct and easier to observe without the need for staining. 

In the context of the figure caption, using DIC optics allowed the researchers to clearly delineate the layered structure of the macaque retina—the **plexiform layers** and the **nuclear layers (ONL, INL, ganglion cell layer)**—in a fresh or relatively unstained preparation.
-->
</section>
<section id="sec-adaptive-optics" class="level2" data-number="22.5">
<h2 data-number="22.5" class="anchored" data-anchor-id="sec-adaptive-optics"><span class="header-section-number">22.5</span> Adaptive optics</h2>
<p>In the late 1990s, it became possible to measure how the physiological optics blurs the light in the living human eye. A key technology for making this measurement is <strong>adaptive optics</strong>, based on a measurement device called the <strong>Shack-Hartmann (S-H) wavefront sensor</strong>. This wavefront sensor was originally developed by astronomers pointing their telescopes at the stars. They knew that the wavefront from space was distorted by the atmosphere. They developed the sensor and adaptive optics system to measure the wavefront distortion and correct it.</p>
<p>The principle of the measurement is illustrated in <a href="#fig-wavefront-aberrometer" class="quarto-xref">Figure&nbsp;<span>22.4</span></a>. A narrow beam of light is directed through the center of the pupil. Some of the light is reflected from the retina, at the layer between the inner and outer segements of the receptors. The reflected light is Lambertian (spread in all directions) and fills up the lens as it passes back through the optics. If the optics were perfect, the rays exiting the eye from the small spot would be close to collimated and the wavefront would be a constant. But the rays are not parallel and thus the wavefront has some deviations from constant. These are the aberrations that we measure at the S-H wavefront sensor. They are introduced by the optics of the eye.</p>
<div id="fig-wavefront-aberrometer" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-wavefront-aberrometer-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/human/02-spatial-encoding/wavefront-aberrometer.png" class="img-fluid figure-img" style="width:60.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-wavefront-aberrometer-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;22.4: Wavefront measurement.
</figcaption>
</figure>
</div>
<p>In addition to measuring the optics, the S-H wavefront sensor enables to additional functions. First, we can use knowledge of the wavefront distortion, to create a very sharp image at the back of the eye. We do this by pre-distorting the rays of our image before they pass through the optics. This way, the effect of the optical aberrations is to cause the reflected rays to be without any distortion and thus the image is diffraction limited. Such an image can be localized to a small spot, exciting just a single cone.</p>
<p>Second, we can use the method to create a relatively sharp image of the retina. When the pupil aperture is fairly large, say 7 mm diameter, the diffraction-limited PSF (Airy disk) will have a small diameter of about 3 microns. Scanning a spot across the retina provides an point-by-point image of the back of the eye, blurred only by the 3 microns of the Airy disk. This technique, called adaptive optics - scanning laser ophthalmoscope (<strong>AOSLO</strong>)- enables us to form a crisp image of many parts of the photoreceptor mosaic.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Shack-Hartmann">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Shack-Hartmann
</div>
</div>
<section id="sec-wavefront-sensor" class="level3 callout-body-container callout-body" data-number="22.5.1">
<h3 data-number="22.5.1" class="anchored" data-anchor-id="sec-wavefront-sensor"><span class="header-section-number">22.5.1</span> Shack–Hartmann wavefront sensor</h3>
<p>Johannes Franz Hartmann was a German astronomer working on the problem of detecting optical defects in telescope objectives. Reasoning from the ray theory of light, he measured the optical light field from a simple stimulus: an on-axis point at the focal length of the lens. In principle, the rays emerging from an ideal lens would all be parallel to the main axis. To measure deviations from the ideal, he created a screen comprising an array of pinholes. If the rays exiting the lens were parallel, the light through each pinhole would create a spot that is nicely centered behind the pinhole. If the rays from the lens were not parallel, the image behind the pinhole would be displaced by from the center. The measured displacements could guide how the lens might be improved.</p>
<p>In practice, the image from each pinhole produces a blurry spot due to diffraction. Thus Hartmann did not try to extract an image; he just estimated the central position of the blurry spot. Also, because the pinholes only let through a small amount of light, the technique was not very sensitive.</p>
<p>Hopefully these ideas are familiar to you by now - it is the same principle we used when describing the light field measurements (<a href="lightfields-01-intro.html#sec-lightfield-measurement" class="quarto-xref"><span>Section 2.7</span></a>, <a href="lightfields-01-intro.html#fig-lightfield-pixel" class="quarto-xref">Figure&nbsp;<span>2.7</span></a>). Because there is an array of these pinholes, the accumulation of pinhole images measures the rays at multiple angles at multiple positions. In principle, by performing this measurement for different wavelengths and polarizations, we sample the optical light field (<a href="lightfields-01-intro.html#eq-lightfield-optical" class="quarto-xref">Equation&nbsp;<span>2.3</span></a>).</p>
<!--
The Raskar version in which you put spots behind the lenslet array and adjust the spots to make the array uniform is kind of funny.  It is intended to measure the optical aberrations of the eye
https://en.wikipedia.org/wiki/Shack%E2%80%93Hartmann_wavefront_sensor
-->
<p><a href="https://www.optics.arizona.edu/sites/default/files/2022-07/Historical-Development-Shack-Hartman-Wavefront-Sensor.pdf?utm_source=chatgpt.com">Arizona History of the Shack work.</a></p>
</section>
</div>
<!--
My chatgpt conversation about AO and AOSLO imaging. This book should have a short form of that.  A longer explanation can go into FOV 2nd ed.

https://chatgpt.com/share/690926d6-4d98-8002-b395-5e93bb3f900a
-->
</section>
<section id="photoreceptor-types" class="level2" data-number="22.6">
<h2 data-number="22.6" class="anchored" data-anchor-id="photoreceptor-types"><span class="header-section-number">22.6</span> Photoreceptor types</h2>
<p>The rod and cone photoreceptors are specialized neurons whose principal function is to convert electromagnetic radiation into a neural signal. Both types of photoreceptors accomplish this using a light-sensitive pigment (photopigment). This pigment absorbs photons and, in so doing, initiates a chain reaction of events within the cell (<span class="citation" data-cites="stryer1986-annrev">Stryer (<a href="references.html#ref-stryer1986-annrev" role="doc-biblioref">1986</a>)</span>). These events, the transduction cascade, result in a change in the synaptic signal from the photoreceptor. The spatio-temporal pattern of changes across the photoreceptor mosaic is the signal that the nervous system interprets and the basis of our sight.</p>
<p>The arrows at the bottom indicate the direction of the incoming light (the lens is below). The light arrives at the photoreceptor layer, brought into focus by the physiological optics. Some of the light enters the cell through the inner-segment aperture. Because of the refractive-index contrast between the inner segment and surrounding medium, the inner segment acts as a waveguide that directs the light toward the outer segment, where it initiates the transduction cascade.</p>
<!-- These folks think that the mitochondria act as microlenses to guide the light within the cone photoreceptors (@ball2022-cones-microlens). -->
<div id="fig-photoreceptors" class="figure quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-photoreceptors-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Simple rod and cone</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Detailed rod and cone</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div id="fig-photoreceptor-baylor" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-photoreceptor-baylor-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/human/02-spatial-encoding/photoreceptor-baylor.png" class="img-fluid figure-img" style="width:50.0%" data-ref-parent="fig-photoreceptors">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-photoreceptor-baylor-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Denis Baylor’s Proctor Medal award included this very simple diagram, which he entitled ‘A physiologist’s diagram of a rod and cone.’ The horizontal lines show the stacks of photosensitive pigment molecules within the outer segment of these cells. The arrangement differs between the rods and cones. In the rods, the photopigment is mainly contained in discs (saccules) that are not continuous with the cell’s surface membrane. In the cones, the photosensitive membrane is continuous with the cell surface. The absorption of a photon initiates a series of events (transduction cascade) that modulates the membrane potential and the rate of synaptic transmitter release. The transmitter itself is packaged in synaptic vesicles, shown by the circles. Source: <span class="citation" data-cites="baylorPhotoreceptorSignalsVision1987">Baylor (<a href="references.html#ref-baylorPhotoreceptorSignalsVision1987" role="doc-biblioref">1987</a>)</span>
</figcaption>
</figure>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div id="fig-photoreceptor-anatomy" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-photoreceptor-anatomy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/human/02-spatial-encoding/photoreceptor-cote.png" class="img-fluid figure-img" style="width:50.0%" data-ref-parent="fig-photoreceptors">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-photoreceptor-anatomy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Cote’s review article paints a more detailed picture of the anatomical and functional elements of the rod and cone receptors. Source: <span class="citation" data-cites="cote2006-photoreceptor">Cote (<a href="references.html#ref-cote2006-photoreceptor" role="doc-biblioref">2006</a>)</span>, Fig 8.1
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-photoreceptors-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;22.5: The photoreceptors convert electromagnetic radiation into a neural signal. The radiation enters the photoreceptor through the inner segment and is absorbed by the photosensitive molecules in the outer segment. The absorption initiates a series of chemical events resulting in transmitter release at the synaptic ending.
</figcaption>
</figure>
</div>
<p>The rod and cone photoreceptors are two largely distinct systems. The rods are mainly used to provide vision under low light levels (scotopic; e.g., nighttime). There is only one type of rod photopigment, rhodopsin. For this reason the rod system provides no information to compare the different wavelengths of light incident at the retina.</p>
<p>The cone photoreceptors dominate vision at modest to high levels of illumination. There are three types of cones, containing three different photopigments. These photopigments absorb over a fairly broad wavelength band, but they have different peak sensitivities in the long-, middle-, and short-wavelength parts of the visible spectrum. I will cover more on this in the color section below.</p>
<p>The spatial resolution of the human eye depends on the aperture size and spacing of the photoreceptor inner segments, particularly for the cones. A great deal was discovered about the sampling mosaic in the 1980s and 1990s <span class="citation" data-cites="curcioHumanPhotoreceptorTopography1990">Curcio et al. (<a href="references.html#ref-curcioHumanPhotoreceptorTopography1990" role="doc-biblioref">1990</a>)</span>. Prior to that time, the nature of the cone sampling mosaic and the importance of sampling were not widely appreciated. The importance of sampling was emphasized by Yellott and colleagues, who analyzed the spatial sampling. William Miller and Joy Hirsch, at Yale, were among the first to crisply show the dense packing (<span class="citation" data-cites="miller1987-conesampling">Hirsch and Miller (<a href="references.html#ref-miller1987-conesampling" role="doc-biblioref">1987</a>)</span>). Over small patches of the primate retina the packing is quite dense (<a href="#fig-inner-segment-miller" class="quarto-xref">Figure&nbsp;<span>22.6</span></a>), in a spatial arrangement called a triangular (hexagonal) packing.</p>
<div id="fig-inner-segment-miller" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-inner-segment-miller-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/human/02-spatial-encoding/inner-segments-foveal.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-inner-segment-miller-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;22.6: Cone inner segment spatial sampling. Source: <span class="citation" data-cites="miller1987-conesampling">Hirsch and Miller (<a href="references.html#ref-miller1987-conesampling" role="doc-biblioref">1987</a>)</span> (personal communication)
</figcaption>
</figure>
</div>
<p>How does the spatial sampling of the cones compare to the optical PSF? One comparison we can make is for the central fovea. There the inner-segment apertures are about 1.5–2 microns in diameter. Using ISETCam we can calculate the diffraction-limited Airy disk diameter (first minimum) for a 550 nm light. For a 3 mm pupil, the f-number of the human optics is 17 mm / 3 mm ≈ 5.6. Using <a href="optics-01-geometric.html#eq-airydisk1" class="quarto-xref">Equation&nbsp;<span>7.2</span></a>, this is:</p>
<pre><code>&gt;&gt; radius = airyDisk(550,5.6,'units','um','diameter',true)
radius =
    7.5152</code></pre>
<p>This calculation shows that a tiny point in the scene -say star light- will be spread over a diameter of about 7 <span class="math inline">\(\mu\text{m}\)</span> on the retinal surface, which corresponds to a 3 or 4 foveal cones. In natural vision, therefore, no stimulus will excite a single photoreceptor; the nervous system always receives signals from multiple cones, even if it draws the inference that the source is a single, very tiny point of light.</p>
<p>One reason for creating such a system that spreads the light over several cones may be to enable us to judge the wavelength information. It is likely that spreading the light across 5-10 cones will engage cones with more than one type of photopigment, and the relative excitation of the different types of cones is the signal we use to judge color. We encountered a similar principle when describing the color filter array in cameras; designers purposefully introduced some blur so that any small region of the scene would engage the R,G and B pixels (<a href="sensors-04-components.html#sec-sensor-cfa" class="quarto-xref"><span>Section 17.3.2</span></a>).</p>
<p>What is the arrangement of the different cone types in the human eye? Some data on this point emerged in the 1980s and 1990s when biologists discovered fluorescent markers that would attach to just one type of photoreceptor (<span class="citation" data-cites="demonasterio1981-scones">DeMonasterio et al. (<a href="references.html#ref-demonasterio1981-scones" role="doc-biblioref">1981</a>)</span>, <span class="citation" data-cites="demonasterio1985-scones">Monasterio et al. (<a href="references.html#ref-demonasterio1985-scones" role="doc-biblioref">1985</a>)</span> <span class="citation" data-cites="wikler1990-photoreceptor-subtypes">Wikler and Rakic (<a href="references.html#ref-wikler1990-photoreceptor-subtypes" role="doc-biblioref">1990</a>)</span>). These measurements could distinguish the L,M cones from the S-cones.</p>
<div id="fig-cone-type-sampling" class="figure quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cone-type-sampling-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Cone types</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">S-cones sampling</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div id="fig-scones-wikley" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-scones-wikley-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/human/02-spatial-encoding/s-cone-sampling.png" class="img-fluid figure-img" style="width:80.0%" data-ref-parent="fig-cone-type-sampling">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-scones-wikley-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) L,M cone types, intermixed with rods, and some S-cone hints. Lots of rods. Near periphery. Source: <span class="citation" data-cites="wikler1990-photoreceptor-subtypes">Wikler and Rakic (<a href="references.html#ref-wikler1990-photoreceptor-subtypes" role="doc-biblioref">1990</a>)</span>
</figcaption>
</figure>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div id="fig-scones-schein" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-scones-schein-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/human/02-spatial-encoding/scones-schein.png" class="img-fluid figure-img" style="width:80.0%" data-ref-parent="fig-cone-type-sampling">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-scones-schein-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) S-cone procion yellow staining from de Monasterio and Schein. Source <span class="citation" data-cites="demonasterio1981-scones">DeMonasterio et al. (<a href="references.html#ref-demonasterio1981-scones" role="doc-biblioref">1981</a>)</span> see also <span class="citation" data-cites="demonasterio1985-scones">Monasterio et al. (<a href="references.html#ref-demonasterio1985-scones" role="doc-biblioref">1985</a>)</span>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cone-type-sampling-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;22.7: Cone mosaics of the different cone types are interleaved. The L and M cone mosaics are interleaved approximately randomly at high resolution. The S-cone mosaic samples the image much more coarsely, and it is relatively more uniform.
</figcaption>
</figure>
</div>
<p>About ten years later, new estimates that could distinguish between the L- from M-cones were obtained in the living human eye. These measurements used adaptive optics coupled with knowledge about the relative wavelength selectivity of the different cone types (<span class="citation" data-cites="roorda1999-conetypes">Roorda and Williams (<a href="references.html#ref-roorda1999-conetypes" role="doc-biblioref">1999</a>)</span>, <span class="citation" data-cites="hofer2005-cone-mosaic">Hofer et al. (<a href="references.html#ref-hofer2005-cone-mosaic" role="doc-biblioref">2005</a>)</span>, <span class="citation" data-cites="hofer2014-retinalmosaic">Hofer and Williams (<a href="references.html#ref-hofer2014-retinalmosaic" role="doc-biblioref">2014</a>)</span>). I explain these measurements in the Foundations of Vision, 2nd edition. When that gets written.</p>
<div id="fig-hofer-mosaic" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hofer-mosaic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/human/02-spatial-encoding/hofer2005.png" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hofer-mosaic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;22.8: Source:<span class="citation" data-cites="hofer2005-cone-mosaic">Hofer et al. (<a href="references.html#ref-hofer2005-cone-mosaic" role="doc-biblioref">2005</a>)</span>, Figure 4
</figcaption>
</figure>
</div>
<p>These measurements revealed something that was quite surprising to vision scientists: the ratio of L- to M- cones in the living human eye differs greatly between people. Some of us have equal numbers of L- and M- cones, while others have a large predominance of L-cones. To this point in time, we have not learned how to measure these differences in behavioral experiments, although there have been some attempts. I suspect that an enterprising engineer or scientist will find a means to do so in the future. One of the reasons that the difference is hard to reveal is that the L- and M-cones are so similar to one another.</p>
</section>
<section id="cone-mosaic-at-different-eccentricities" class="level2" data-number="22.7">
<h2 data-number="22.7" class="anchored" data-anchor-id="cone-mosaic-at-different-eccentricities"><span class="header-section-number">22.7</span> Cone mosaic at different eccentricities</h2>
<p>The cone spatial sampling density and inner segment aperture size varies a great deal between the fovea and periphery. In the central fovea, the cones are tightly packed and their inner segment aperture diameters are very small (1-2 microns). In the periphery the cones are much more widely spaced and their inner segment apertures are nearly ten times larger (<a href="#fig-cone-mosaic-density" class="quarto-xref">Figure&nbsp;<span>22.9</span></a>). Hence, our encoding of the retinal irradiance is very different between the fovea and periphery.</p>
<!--
There is an ISETBio figure related to s_coneEccentricities.m that we could include.
-->
<div id="fig-cone-mosaic-density" class="figure quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cone-mosaic-density-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Fovea</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">3 deg</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">6 deg</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-4" role="tab" aria-controls="tabset-6-4" aria-selected="false">12 deg</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div id="fig-mosaic-0" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-mosaic-0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/human/02-spatial-encoding/coneMosaic-0-deg.svg" class="img-fluid figure-img" style="width:70.0%" data-ref-parent="fig-cone-mosaic-density">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-mosaic-0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Simulation centered on the fovea. Notice that there are no S-cones in the very center and no rods throughout.
</figcaption>
</figure>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div id="fig-mosaic-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-mosaic-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/human/02-spatial-encoding/coneMosaic-3-deg.svg" class="img-fluid figure-img" style="width:70.0%" data-ref-parent="fig-cone-mosaic-density">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-mosaic-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Simulation at 3 deg eccentricity. The inner segment apertures have increased in size. S-cones are present, but few rods.
</figcaption>
</figure>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div id="fig-mosaic-6" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-mosaic-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/human/02-spatial-encoding/coneMosaic-6-deg.svg" class="img-fluid figure-img" style="width:70.0%" data-ref-parent="fig-cone-mosaic-density">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-mosaic-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) ISETBio simulations oat 6 deg eccentricity. Even larger apertures. Space for some rods.
</figcaption>
</figure>
</div>
<!--![](images/human/02-spatial-encoding/coneMosaic-6-deg.svg){fig-cap="Cone inner-segment apertures from fovea to periphery" fig-cap-location=margin width="0.5\\textwidth"}-->
<!-- ![](images/human/02-spatial-encoding/coneMosaic-6-deg.svg){fig-cap="Cone inner-segment apertures from fovea to periphery" fig-cap-location=bottom width="0.5\\textwidth"}-->
</div>
<div id="tabset-6-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-4-tab">
<div id="fig-mosaic-12" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-mosaic-12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/human/02-spatial-encoding/coneMosaic-12-deg.svg" class="img-fluid figure-img" style="width:70.0%" data-ref-parent="fig-cone-mosaic-density">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-mosaic-12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d) Simulation at 12 deg eccentricity. Aperture size is increased to XX microns. Lots of space for the rods between the cones.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cone-mosaic-density-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;22.9: ISETBio simulations of the cone sampling mosaic at four different eccentricities. Source: fise_humanMosaic.m
</figcaption>
</figure>
</div>
<!-- See fise_humanConePSF.m in code/human -->
</section>
<section id="psf-at-the-cone-inner-segments" class="level2" data-number="22.8">
<h2 data-number="22.8" class="anchored" data-anchor-id="psf-at-the-cone-inner-segments"><span class="header-section-number">22.8</span> PSF at the cone inner segments</h2>
<p>We are now ready to describe the optical spread with respect to the cone spatial sampling. First, we illustrate for a typical person how the PSF changes with visual field eccentricity. Second, wwe illustrate how the PSF changes with wavelength.</p>
<section id="eccentricity-dependence" class="level3" data-number="22.8.1">
<h3 data-number="22.8.1" class="anchored" data-anchor-id="eccentricity-dependence"><span class="header-section-number">22.8.1</span> Eccentricity dependence</h3>
<p>The set of images in this panel illustrates the PSF on the cone mosaic for locations in the central fovea, 3 deg, 6 deg and 12 deg. The original scene is a set of 9 points (3 x 3), spanning about half a degree. The points are broadband lights. In the fovea, the PSF excites about 3-7 cones. In this region this light causes about 2000 excitations per cone.</p>
<p>In the peripheral locations the cone inner segment apertures are bigger, and the blur is bigger as well. The larger blur matches the increased size of the cone apertures, so once again about 3-7 cones are significantly excited. Further, the cones all absorb about 2000 photons. for this subject, at 12 deg eccentricities, the cone apertures are not quite as well matched. Only 2-4 cones are significantly excited and they each capture about 4000 photons.</p>
<div id="fig-cone-psf" class="figure quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cone-psf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">Fovea</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">3 deg</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">6 deg</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-4" role="tab" aria-controls="tabset-7-4" aria-selected="false">12 deg</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div id="fig-mosaic-0" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-mosaic-0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/human/02-spatial-encoding/conePSF-0-deg.svg" class="img-fluid figure-img" style="width:70.0%" data-ref-parent="fig-cone-psf">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-mosaic-0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Each black circle represents the aperture of a cone inner segment. The hot colormap represents the number of expected excitations from the light. In the fovea region each point excites 3-7 cones significantly above the background level.
</figcaption>
</figure>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div id="fig-mosaic-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-mosaic-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/human/02-spatial-encoding/conePSF-3-deg.svg" class="img-fluid figure-img" style="width:70.0%" data-ref-parent="fig-cone-psf">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-mosaic-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) At 3 deg of eccentricity the cone inner segments are much larger, but the PSF is larger as well. Again, about 3-7 cones are excited above tehe background.
</figcaption>
</figure>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<div id="fig-mosaic-6" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-mosaic-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/human/02-spatial-encoding/conePSF-6-deg.svg" class="img-fluid figure-img" style="width:70.0%" data-ref-parent="fig-cone-psf">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-mosaic-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) At 6 deg of eccentricity the cone inner segments are larger again, and the PSF is slightly larger as well. Again, about 3-7 cones are excited above the background
</figcaption>
</figure>
</div>
</div>
<div id="tabset-7-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-4-tab">
<div id="fig-mosaic-12" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-mosaic-12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/human/02-spatial-encoding/conePSF-12-deg.svg" class="img-fluid figure-img" style="width:70.0%" data-ref-parent="fig-cone-psf">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-mosaic-12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d) Finally, at 12 deg eccentricity the blur and cone aperture sizes may diverge a bit so that slightly ewer cones, perhaps 2-5, have elevated absorption rates compared to the background.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cone-psf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;22.10: ISETBio simulations of the PSF superimposed on the cone sampling mosaic. The four panels show four different eccentricities. This precise pattern varies between subjects because we all have slightly different optics and mosaics. The main trend, which we believe to be true, is that the blur and cone aperture size both increase with eccentricity. In some cases, as illustrated here, the two changes approximately balance one another so that the same number of cones are stimulated by about the same amount. The optical blur is from one example subject based on Artal optics measurements. Source: fise_humanConePSFm
</figcaption>
</figure>
</div>
<p>If we measure an input-referred spatial resolution, the eye’s sensitivity is considerably reduced with eccentricity. If we think purely in terms of the number of excited cones, the signal is much closer to constant from fovea to periphery. Perhaps this latter measure is the important one for how the nervous system is wired up. I can speculate a little, right? Though I sure would like a better story.</p>
</section>
<section id="psf-wavelength-dependence" class="level3" data-number="22.8.2">
<h3 data-number="22.8.2" class="anchored" data-anchor-id="psf-wavelength-dependence"><span class="header-section-number">22.8.2</span> PSF wavelength dependence</h3>
<p>In normal viewing, the human eye’s optics brings the middle wavelengths are in good focus at the inner segment. Because of chromatic aberration, the short wavelength light is focused at the RGC layer, and measured at the inner segment layer the short wavelength light is considerably spread out (<a href="#fig-cone-psf-wavelength" class="quarto-xref">Figure&nbsp;<span>22.11</span></a>). The defocus of the short wavelength light is wired into the design of the cone sampling density.</p>
<p>We can see this by comparing the spacing of the L- and M-cones with the S-cone (<a href="#fig-cone-psf-wavelength" class="quarto-xref">Figure&nbsp;<span>22.11</span></a>). That figure shows the sampling density of the L,M cones separately from the much lower sampling density of the S-cones. There are about 3-5 cones within the point spread of the middle wavelength light, and there are also about 3-5 S-cones within the point spread of the short-wavelength light. Nature has evolved a photoreceptor mosaic so that the spatial sampling of each cone type matches the wavelength-dependent optical blur.</p>
<div id="fig-cone-psf-wavelength" class="figure quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cone-psf-wavelength-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">PSF for 550nm</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">PSF for 480nm</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div id="fig-psf-550nm" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-psf-550nm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/human/02-spatial-encoding/psf-scone-1.png" class="img-fluid figure-img" style="width:60.0%" data-ref-parent="fig-cone-psf-wavelength">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-psf-550nm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) PSF at 3 deg: 550nm
</figcaption>
</figure>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div id="fig-psf-450nm" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-psf-450nm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/human/02-spatial-encoding/psf-scone-2.png" class="img-fluid figure-img" style="width:60.0%" data-ref-parent="fig-cone-psf-wavelength">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-psf-450nm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) PSF at 3 deg: 480nm
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cone-psf-wavelength-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;22.11: The two tabs show the approximate size of the point spread function at two different wavelengths, 550 nm and 450 nm, estimated at the inner segments. The spread is superimposed on the photoreceptor sampling mosaic. The retinal region shown here is in the near periphery, where there are both rods and cones.
</figcaption>
</figure>
</div>
<p>Modern measurements of the eye’s wavefront aberrations enable us to simulate the wavelength-dependent PSF at the cone mosaic effect. Recall that in the very center of the fovea, there are no S-cones. But there are some about 0.2 deg in the periphery. If you click on the images in <a href="#fig-cone-psf-wavelength-isetbio" class="quarto-xref">Figure&nbsp;<span>22.12</span></a>, you will see a simulation of the absorptions along with a label of the cone type by the color of the circle around each cone. For the 550 nm light in the left panel, the excitations are spread over only about 3 cones.</p>
<div id="fig-cone-psf-wavelength-isetbio" class="figure quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cone-psf-wavelength-isetbio-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">PSF for 550nm</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">PSF for 480nm</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div id="fig-psf-550nm" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-psf-550nm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/human/02-spatial-encoding/conePSF-550.png" class="img-fluid figure-img" style="width:60.0%" data-ref-parent="fig-cone-psf-wavelength-isetbio">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-psf-550nm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) PSF at 3 deg: 550nm
</figcaption>
</figure>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div id="fig-psf-480nm" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-psf-480nm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/human/02-spatial-encoding/conePSF-480.png" class="img-fluid figure-img" style="width:60.0%" data-ref-parent="fig-cone-psf-wavelength-isetbio">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-psf-480nm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) PSF at 3 deg: 480nm
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cone-psf-wavelength-isetbio-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;22.12: The two tabs show simulations of the cone excitations in response to a point of light (PSF). The left panel is for a 550 nm light and the right for a 480 nm light. The simulation is for the central fovea region.
</figcaption>
</figure>
</div>
<p>For the 450 nm light in the right panel, the PSF is spread over a larger retinal region. But again, click on the image to see it enlarged in a new tab. The number of S-cones excited by the short-wavelength PSF is still only 3-5, as in <a href="#fig-cone-psf-wavelength" class="quarto-xref">Figure&nbsp;<span>22.11</span></a>. The number of excitations of all the cones, including the S-cones, is much lower for the short-wavelength light. Recall that the short-wavelength light is absorbed by the cornea, lens, and macular pigment. To equate the number of absorptions, we would need to scale the intensity of the light quite a bit.</p>
</section>
</section>
<section id="spatial-sensitivity-in-the-transform-domain" class="level2" data-number="22.9">
<h2 data-number="22.9" class="anchored" data-anchor-id="spatial-sensitivity-in-the-transform-domain"><span class="header-section-number">22.9</span> Spatial sensitivity in the transform domain</h2>
<p>The usefulness of the analyses in the transform domain, in engineering generally and optics specifically, led vision scientists to ask whether measurements using harmonics could be useful for understanding and characterizing the human visual system. Perhaps the first person to see the potential application was the image systems engineer Otto Schade. This is the person who developed the concept of the modulation transfer function (MTF) for image systems engineering questions (<a href="optics-06-linear-transform.html#sec-MTF" class="quarto-xref"><span>Section 12.4.2</span></a>).</p>
<p>I created four Google docs with historical information about CSF measurements, how to download the historical data, and how to imlement the modern models of the historical and more modern data. Integrate those pages here and write some Matlab scripts to create figures.</p>
<p>Show the data he collected of the CSF (1/MTF) he measured that I include in FOV. Maybe in the human spatial encoding chapter.</p>
<p>The use of harmonics to probe the visual system is quite different from their use in studying typical systems. At many points in this volume I have pointed out that harmonics are particularly valuable stimuli for space-invariant linear systems <a href="appendix-02-spaceinvariance.html" class="quarto-xref"><span>Chapter 30</span></a>. These systems have an input and an output. THe use of harmonic stimuli in human vision faces two significant limitations. First, as we have just seen, the system is not at all space-invariant (<a href="#fig-cone-mosaic-density" class="quarto-xref">Figure&nbsp;<span>22.9</span></a>). It is justifiable to use harmonics as special stimuli over small regions of the retina, which can be close to space-invariant. Stimuli that span more than a degree or two will not have the special property (harmonics being nearly eigenfunctions) that make them so useful in systems analysis.</p>
<p>Second, even at the earliest stages of vision the encoding is not restricted to a single system.</p>
<section id="sec-contrast-sensitivity" class="level3" data-number="22.9.1">
<h3 data-number="22.9.1" class="anchored" data-anchor-id="sec-contrast-sensitivity"><span class="header-section-number">22.9.1</span> Contrast sensitivity functions (CSF)</h3>
<p>Optical scientists use both the space domain (PSF) and the transform domain (MTF) to study their system, and vision scientists use both domains as well. The nonuniformity of the optical blur, coupled with the nonuniformity of the cone spatial sampling, imply that shift-invariant methods only make sense over patches of the visual field. As a result, the carefully controlled harmonics used in vision experiments are modulated over relatively small regions of space.</p>
<p>There are several ways in which this modulation is accomplished in experiments, though perhaps the most common is to use a <strong>Gabor function</strong>; named after Denis Gabor, the Nobel Laureate credited with the discovery of the laser.</p>
<p><span id="eq-gabor-function"><span class="math display">\[
\begin{aligned}
g(x,y) &amp;= \exp\!\left(
  -\frac{(x - x_0)^2 + (y - y_0)^2}{2\sigma^2}
\right)
[1 + a \cos\!\big(2\pi f x +  \phi\big)]
\end{aligned}
\tag{22.1}\]</span></span></p>
<p>Gabor functions are harmonics modulated by a Gaussian. The standard deviation of the Gaussian (<span class="math inline">\(\sigma\)</span>) controls the spatial spread; the frequency of the harmonic <span class="math inline">\(f\)</span>, controls the center frequency of the image. The phase term, <span class="math inline">\(\phi\)</span>, controls the spatial relationship between the harmonic and the peak of the Gaussian. The central position in the visual field is <span class="math inline">\((x_0,y_0)\)</span>, and the amplitude of the harmonic is controlled by <span class="math inline">\(a\)</span>.</p>
<p>Figure: Show images of different Gabors.</p>
<p>Contrast sensitivity functions (CSF) measured with Gabor patches shown here. Should we adjust <span class="math inline">\(f\)</span> and <span class="math inline">\(\sigma\)</span> together, or should we fix <span class="math inline">\(\sigma\)</span> and adjust <span class="math inline">\(f\)</span> on its own.</p>
</section>
<section id="vernier-acuity" class="level3" data-number="22.9.2">
<h3 data-number="22.9.2" class="anchored" data-anchor-id="vernier-acuity"><span class="header-section-number">22.9.2</span> Vernier acuity</h3>
<div class="callout callout-style-default callout-note callout-titled" title="Pierre Vernier">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Pierre Vernier
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>https://www.fisicanet.com.ar/biografias/cientificos/v/vernier-pierre.php</p>
<p>Something about Vernier calipers and the story of Pierre Vernier.</p>
<div id="fig-vernier" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-vernier-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/human/02-spatial-encoding/Vernier_fisica.png" class="img-fluid figure-img" style="width:60.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-vernier-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;22.13: Pierre Vernier.
</figcaption>
</figure>
</div>
<p>Historical</p>
<p>https://en.wikisource.org/wiki/1911_Encyclop%C3%A6dia_Britannica/Vernier,_Pierre</p>
</div>
</div>
</div>
</section>
</section>
<section id="todo" class="level2" data-number="22.10">
<h2 data-number="22.10" class="anchored" data-anchor-id="todo"><span class="header-section-number">22.10</span> TODO</h2>
<p>Not sure the astronomy one should be here. Shack-Hartmann should, I think.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Astronomy and adaptive optics">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Astronomy and adaptive optics
</div>
</div>
<div class="callout-body-container callout-body">
<p>https://en.wikipedia.org/wiki/Pierre_Vernier</p>
<p>fisicanet.com.ar/biografias/cientificos/v/vernier-pierre.php</p>
</div>
</div>
<section id="sec-telescopes" class="level3" data-number="22.10.1">
<h3 data-number="22.10.1" class="anchored" data-anchor-id="sec-telescopes"><span class="header-section-number">22.10.1</span> Ground-based telescopes</h3>
<p>quatThese same technologies can be used to look inward, within the eye, rather than outward toward the stars. Realizing this was a very important insight that continues to lead to important insights about the peripheral human visual system (<a href="human-01-seeing.html#sec-human-seeing-overview" class="quarto-xref"><span>Section 21.1</span></a>).</p>
<p>Where should the adaptive optics measurement method be? Here or FOV? Adaptive optics measurements of wavefront aberrations, expressed as point spread functions. Thibos and Artal data.</p>
<p>The ability to measure certain properties of the optics was revolutionized by adpative optics - a method that makes real time measurements of the wavefront aberrations of the physiological optics using a Shack-Hartmann wavefront sensor. Just the measurement of the aberrations alone is useful. In addition, it has proben possible to engineer systems that correct for these aberrations in real time, and thus visualize the apertures of the photoreceptors (1-5 <span class="math inline">\(\mu \text{m}\)</span> diameter) cells in the retina. Further, using video tracking of the eye movements it has proven possible to deliver stimuli to specific, targeted photoreceptors.</p>
<p>First order approximations of the human optics. Simulations with ISETBio of maybe the Westheimer or Ijspeert functions. Eye models?</p>
<p>:::</p>



<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-baylorPhotoreceptorSignalsVision1987" class="csl-entry" role="listitem">
Baylor DA (1987) <a href="https://www.ncbi.nlm.nih.gov/pubmed/3026986">Photoreceptor signals and vision. <span>Proctor</span> lecture</a>. Investigative Ophthalmology and Visual Science 28:34–49
</div>
<div id="ref-cote2006-photoreceptor" class="csl-entry" role="listitem">
Cote RH (2006) <a href="http://dx.doi.org/10.1201/9781420020847-8/photoreceptor-phosphodiesterase-pde6-protein-activated-pde-regulating-visual-excitation-rod-cone-photoreceptor-cells-rick-cote">Photoreceptor phosphodiesterase (<span>PDE6</span>): A <span>G</span>-protein-activated <span>PDE</span> regulating visual excitation in rod and cone photoreceptor cells</a>. In: Cyclic nucleotide phosphodiesterases in health and disease. CRC Press, pp 165–193
</div>
<div id="ref-curcioHumanPhotoreceptorTopography1990" class="csl-entry" role="listitem">
Curcio CA, Sloan KR, Kalina RE, Hendrickson AE (1990) Human photoreceptor topography. Journal of Comparative Neurology 292:497–523
</div>
<div id="ref-demonasterio1981-scones" class="csl-entry" role="listitem">
DeMonasterio FM, Schein SJ, McCrane EP (1981) <a href="http://dx.doi.org/10.1126/science.7268439">Staining of blue-sensitive cones of the macaque retina by a fluorescent dye</a>. Science 213:1278–1281
</div>
<div id="ref-miller1987-conesampling" class="csl-entry" role="listitem">
Hirsch J, Miller WH (1987) <a href="https://opg.optica.org/abstract.cfm?uri=josaa-4-8-1481">Does cone positional disorder limit resolution?</a> Journal of the Optical Society of America A 4:1481–1492
</div>
<div id="ref-hofer2005-cone-mosaic" class="csl-entry" role="listitem">
Hofer H, Carroll J, Neitz J, et al (2005) <a href="http://dx.doi.org/10.1523/JNEUROSCI.2414-05.2005">Organization of the human trichromatic cone mosaic</a>. J Neurosci 25:9669–9679
</div>
<div id="ref-hofer2014-retinalmosaic" class="csl-entry" role="listitem">
Hofer HJ, Williams DR (2014) Color vision and the retinal mosaic. In: Chalupa LM, Werner JS (eds) The <span>New Visual Neurosciences</span>. MIT Press, Cambridge, MA, pp 469–483
</div>
<div id="ref-massey2006-retinalanatomy" class="csl-entry" role="listitem">
Massey SC (2006) Functional anatomy of the mammalian retina. In: Retina. Elsevier, pp 43–82
</div>
<div id="ref-demonasterio1985-scones" class="csl-entry" role="listitem">
Monasterio FD de, McCrane E, Newlander J, Schein S (1985) <a href="https://iovs.arvojournals.org/article.aspx?articleid=2177000">Density profile of blue-sensitive cones along the horizontal meridian of macaque retina</a>. Invest Ophthalmol Vis Sci 26:289–302
</div>
<div id="ref-roorda1999-conetypes" class="csl-entry" role="listitem">
Roorda A, Williams D (1999) <a href="http://dx.doi.org/10.1038/17383">The arrangement of the three cone classes in the living human eye</a>. Nature 397:520–522
</div>
<div id="ref-stryer1986-annrev" class="csl-entry" role="listitem">
Stryer L (1986) <a href="http://dx.doi.org/10.1146/annurev.ne.09.030186.000511">Cyclic <span>GMP</span> cascade of vision</a>. Annu Rev Neurosci 9:87–119
</div>
<div id="ref-wikler1990-photoreceptor-subtypes" class="csl-entry" role="listitem">
Wikler KC, Rakic P (1990) <a href="http://dx.doi.org/10.1523/JNEUROSCI.10-10-03390.1990">Distribution of photoreceptor subtypes in the retina of diurnal and nocturnal primates</a>. J Neurosci 10:3390–3401
</div>
</div>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Differential Interference Contrast microscopy is a technique that enhances the contrast in unstained, transparent specimens. The microscope converts gradients in specimen thickness or refractive index (which naturally occur at the boundaries of structures like cell layers, membranes, and organelles) into differences in light intensity (contrast). It is particularly useful in imaging the layers of a retina, making features visible that would otherwise be nearly invisible in a brightfield microscope.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../chapters/human-01-seeing.html" class="pagination-link" aria-label="Seeing">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Seeing</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/human-03-wavelength-encoding.html" class="pagination-link" aria-label="Human wavelength encoding">
        <span class="nav-page-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Human wavelength encoding</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>