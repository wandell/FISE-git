## Pinholes and diffraction

If we imagine light as a collection of ray, it is easy to understand why pinhole optics renders a reasonable image (@fig-ayscough). Some of the properties of the pinhole camera, such as why the image is inverted or how it is blurred, are also well-explained by tracing the rays. The formulation of light as rays, which was proposed by Isaac Newton, is a helpful approximation for many optics calculations.

![Pinhole camera geometry. (A) The rays from a distant, on-axis point arrive at in parallel at the pinhole. Were there no diffraction, they would simply continue on to form an image the size of the pinhole. (B) An off-axis point's rays also arrive in parallel, but they are at an angle to the pinhole aperture. Hence, fewer rays pass through the aperture so the image would be dimmer and smaller. If we can tolerate a relatively large point spread, this design is workable. But if we require a small point spread, diffraction makes this design unworkable.](../images/lightfields/pinholePSF.png){#fig-pinhole-basic fig-align="center" width="70%"}

For example, consider a point (A) relatively far from the pinhole (@fig-pinhole-basic). The rays at A radiate in a wide range of directions, but only a small portion of those rays arrive at the pinhole aperture. Because the pinhole forms a very narrow angle from the point the rays in the incident light field will be parallel to one another (collimated). According to the ray model of light, this collection of rays will pass straight through the pinhole and form an image on the recording surface (e.g., Leonardo's wall). The image formed by such a point is called the *point spread function*. For the on-axis point A, the point spread size is equal to the size of the pinhole aperture.

Consider an off-axis point, (B). Again, its rays will spread in many directions but only a narrow, collimated subset of rays will arrive at the aperture. Because of the angle between the collimated rays and the pinhole, a smaller fraction of the rays will pass through the pinhole aperture. The point spread from (B) will be smaller and dimmer. If we can tolerate the reduced intensity and we do not mind the blurring from the pinhole, we will have a satisfactory image.

It is common to simulate light as rays in computer graphics. In @fig-pinhole-chessset I rendered a chess set scene with the pieces, each a few cm tall, positioned about 0.5 meters from the pinhole camera. The four pictures were rendered using different pinhole diameters. The upper left allows only one ray through from each location in the scene. The aperture diameters for the next three pictures are for increasing pinhole sizes. The images are brighter as the pinhole size increases, of course. For this scene geometry the image at the two smaller pinhole sizes are tolerable. Depending on your viewing distance from the screen or page, even the third pinhole image might be usable. But the largest pinhole, which lets in the most light, also loses so much spatial information that the individual pieces blur together.

<!--# Maybe we do some simple geometric calculations in a script and callout here.  Possible ideas are showing how the distance of the image surface from the pinhole and the size of the image surface matter.  Also that the same light is spread over a smaller region when the surface is closer, and a wider region when the surface is further away.  These ideas will reappear below when we measure light levels and also in the optics chapter when we talk about magnification. -->

![A simulated scene imaged with a pinhole camera. The size of the pinhole diameter increases, with the smallest in the upper left, and increasing (upper left to lower right). The relative intensity is preserved in the renderings so that the scene becomes brighter as the pinhole diameter increases. Rendered with [@pharrPBRTVersion4] and [@iset3d2022].](../images/lightfields/01-pinhole-chessset.png){#fig-pinhole-chessset width="80%" fig-align="center"}

### Huygens wave model
Useful as the ray model has been, for more than 300 years scientists have known that describing light as rays is only half right. It is true that increasing the pinhole diameter blurs the image; but the ray tracing analysis fails dramatically in other ways. Consider the simple prediction of the ray model in @fig-ray-wave (A). The rays from a point source at a distance will be nearly parallel. They will pass through a pinhole, continuing along in a straight line. An image cast on a surface behind the pinhole should have the diameter of the pinhole; a person to the side of the pinhole would see it as dark because no rays are heading to his eyes. The Jesuit scientist, Grimaldi, demonstrated that the predictions of the ray model are violated [@Grimaldi1665-physico].

![@Grimaldi1665-physico introduced a pencil of light into a dark room through a hole. According to the ray theory of light, the image on the wall should be the same size as the pinhole, and the rays should not be visible to an observer looking from the side. Grimaldi found that under some conditions the image on the image plane was larger than the pinhole itself, inconsistent with the ray theory of light. Newton confirmed the experiment but continued to use the ray theory because it remained useful for many purposes (A History of Physics, Cajori, p. 88-89). In modern times, we accept the wave theory but often use the ray theory because it works well in many circumstances.](../images/lightfields/01-ray-wave.png){#fig-ray-wave width="80%" fig-align="center"}

The Dutch scientist Christiaan Huygens, working at the same time as Newton, suggested an alternative model: he proposed modeling light as waves that expand to fill space rather than rays made up of particles that travel in a straight line. On Huygen's theory, the light emitted from a point expands as a spherical wave in all directions. At each moment in time the expansion, called the wavefront, could be considered as an array of points that each emitted a secondary wave. This model leads to many quantitative predictions, including how light will be reflected from a mirror and how the light direction will change as the wave passes from one medium (air) into a second medium (glass) (@fig-huygens-waves). We would think of a ray as being a plane wave, spread across space.

![Light modeled as a wavefront. (A) A point source is shown emitting a circular (or 3D, spherical) wave. Each point on the expanding wavefront emits a new spherical wave. The leading edge of these waves reinforce one another to form the expanding wavefront. (B) At a large distance from the source, the small part of the wavefront appears to be a plane wave. Again, each point on the plane emits a spherical wavefront. These are aligned and the wavefront remains planar. (C) When the wavefront arrives at a small aperture only a small part of the wave passes through. This is like the original source, revealing the spherical wavefront from that point.](../images/lightfields/01-huygens-wave.png){#fig-huygens-waves fig-cap-location="bottom" width="80%" fig-align="center"}

A consequence of the wave theory is that as light passes through a pinhole, or near an edge, the spherical waves from each point on the wavefront are revealed. The aperture limits the region of the plane wave that continues on to a much smaller number of points. When restricted in this way, the resulting wavefront is no longer a plane; instead, the sum of the spherical waves from the points sum to a new wavefront that spreads in multiple directions. This phenomenon was called diffraction by Grimaldi. When the pinhole diameter is small, and only a small portion of the plane wave compared to the wavelength of light enters the pinhole, the spherical wavefront becomes quite large and this blurs the image (@fig-huygens-waves).

::: {.callout-note collapse="true" title="What took us so long?"}

### Rays and waves: Engineers don't like to choose
Although the two theories were proposed at about the same time, Newton's ray theory from 1704 was accepted for roughly a century. Widespread recognition of the value of Huygen's wave theory followed Thomas Young's 1804 demonstration, in England to the Royal Society, of the interference pattern created by light passing through two, coherent, nearby sources.

I find it useful to remember the [the history of these ideas.](../supplemental/optics-diffraction.html) There is real value in the ray model which remains widely used for many purposes: even though we know it is not correct in all cases. This very pragmatic approach - use the tool that is accurate enough for the problem at hand - is deeply ingrained in some fields. Approach practical measurements and theories with a toolbox of methods.

Some fields that I have worked in adopted a different philosophy: they rely on hypothesis testing and aim to prove ideas true or false. In this spirit, the phrase 'all models are wrong, some are useful', is widely quoted @box-science-1976. In physics and engineering hypotheses that are half full are still considered valuable, as long as one understands the scope over which the hypotheses can be reasonably applied.
:::
### Which effect blurs more?
The image is blurred by two effects: the pinhole size and diffraction. We can compare the size of these two effects numerically.

![The Airy pattern of a pinhole camera.  The aperture is on the ](../images/lightfields/01-blur-comparison.png){#fig-blur-comparison fig-cap-location='margin' width=80%}

First, consider what we expect from the ray model.  Suppose the pinhole diameter is $D$. For a far-away point, with the rays coming in parallel, we expect the blur size in the image to be $D$. This pinhole-blur expected by the ray model is the same no matter how far the image plane is from the pinhole.

Second, consider the light pattern we expect for a wave passing through a pinhole aperture.  This pattern can be calculated using a formula derived by the astronomer, George B. Airy [@airy-1835-diffraction] and is shown in @fig-blur-comparison. The Airy pattern has a central bright spot (the Airy disk), which is surrounded by a series of concentric rings.  The size of the pattern depends on the wavelength of the light $\lambda$, the diameter of the pinhole $D$, and the distance from the pinhole to the image plane, $L$. The image is radially symmetric with a bright spot in the center, surrounded by a set of concentric rings of decreasing intensity. The Airy disk contains about 85% of the total energy. The mathematical notation for the Airy pattern is a bit complex, but the diameter of the Airy disk, $d$, has a simple formula

$$d= 2.44~L~(\lambda / D)$$ {#eq-airy1}

Suppose we calculate the size of the diffraction diameter when the image plane is 1 m away, so $L=1$, and for a wavelength of light is 550 nm. Suppose the pinhole diameter is $D = 10^{-4} m$. The diameter of the Airy disk, $d$,  will be 

$$2.44 \times (1 m) (550 \times 10^{-9} m )/ 1 \times 10^{-4}m) = 0.0134 m$$ 

The diffraction spread is larger than the pinhole spread when $d$ exceeds $D$. We do the calculation in the scripts in this [ISETCam script](https://htmlpreview.github.io/?https://github.com/wandell/FISE-git/blob/main/code/fise_diffraction.html).  For $L = 1m$ the pinhole blur is larger than the diffraction blur for a diameter of about $1 mm$.  When $L$ is much closer, say $10 mm$, the pinhole blur exceeds the diffraction blur when the diameter is $100 \mu$.

The diffraction spread is larger than the pinhole spread when $d$ exceeds $D$. We do the calculation in the scripts in this [ISETCam script](/code/fise_diffraction.html).  For $L = 1m$ the pinhole blur is larger than the diffraction blur for a diameter of about $1 mm$.  When $L$ is much closer, say $10 mm$, the pinhole blur exceeds the diffraction blur when the diameter is $100 \mu$.

::: {.callout-note collapse="true" title="Airy disk size formula"}
### Airy disk formula {.unnumbered}

In a paper entitled "On the Diffraction of an Object-glass with Circular Aperture", George Airy provided the mathematical description of the diffraction pattern [@airy-1835-diffraction].   A modern derivation of the full point spread function for both the circular aperture and other shapes is in @goodman2022 (pages 88-94). The computation is implemented and frequently used in ISETCam. It is explained [in this tutorial](https://htmlpreview.github.io/?https://github.com/ISET/isetcam/blob/main/tutorials/optics/t_opticsAiryDisk.html).

In the main text, we expressed the formula for a particular distance from the pinhole to an image plane. For a pinhole, the formula is usually given in terms of the angle of the bundle of rays emerging from the pinhole.

$$sin(\theta) = 1.22 \lambda / D$$

When the angle is small, $\theta < 10 \deg$, the formula is very accurately approximated as

$$\theta = 1.22 \lambda / D$$

The size of the spot on the image plane depends on the distance how far away the pinhole is from the pinhole, as you can see in [@eq-airy1]. In @sec-optics we provide a formula for the Airy disk size for ideal lenses.
:::

